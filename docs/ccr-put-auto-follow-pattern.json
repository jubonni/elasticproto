{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.220591",
        "size": 5438,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ccr-put-auto-follow-pattern.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "ccr-put-auto-follow-pattern",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ccr-put-auto-follow-pattern]]\n=== Create auto-follow pattern API\n++++\n<titleabbrev>Create auto-follow pattern</titleabbrev>\n++++\n\nCreates a {ccr} <<ccr-auto-follow,auto-follow pattern>>.\n\n[[ccr-put-auto-follow-pattern-request]]\n==== {api-request-title}\n\n[source,console]\n--------------------------------------------------\nPUT /_ccr/auto_follow/<auto_follow_pattern_name>\n{\n  \"remote_cluster\" : \"<remote_cluster>\",\n  \"leader_index_patterns\" :\n  [\n    \"<leader_index_pattern>\"\n  ],\n  \"leader_index_exclusion_patterns\":\n  [\n    \"<leader_index_exclusion_pattern>\"\n  ],\n  \"follow_index_pattern\" : \"<follow_index_pattern>\"\n}\n--------------------------------------------------\n// TEST[setup:remote_cluster]\n// TEST[s/<auto_follow_pattern_name>/auto_follow_pattern_name/]\n// TEST[s/<remote_cluster>/remote_cluster/]\n// TEST[s/<leader_index_patterns>/leader_index*/]\n// TEST[s/<leader_index_exclusion_pattern>//]\n// TEST[s/<follow_index_pattern>/{{leader_index}}-follower/]\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nDELETE /_ccr/auto_follow/auto_follow_pattern_name\n--------------------------------------------------\n// TEST[continued]\n\n//////////////////////////\n\n[[ccr-put-auto-follow-pattern-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have `read` and `monitor`\nindex privileges for the leader index patterns. You must also have `manage_ccr`\ncluster privileges on the cluster that contains the follower index. For more\ninformation, see <<security-privileges>>.\n\n[[ccr-put-auto-follow-pattern-desc]]\n==== {api-description-title}\n\nThis API creates a new named collection of\n<<ccr-auto-follow,auto-follow patterns>> against the remote cluster\nspecified in the request body. Newly created indices on the remote cluster\nmatching any of the specified patterns will be automatically configured as follower\nindices. Indices on the remote cluster that were created before the auto-follow\npattern is created won't be auto-followed even if they match the pattern.\n\nThis API can also be used to update existing\n<<ccr-auto-follow,auto-follow patterns>>. Note that follower indices that were configured automatically\nbefore updating an auto-follow pattern will remain unchanged even if they don't match against\nthe new patterns.\n\n[[ccr-put-auto-follow-pattern-path-parms]]\n==== {api-path-parms-title}\n`<auto_follow_pattern_name>`::\n  (Required, string) The name of the collection of auto-follow patterns.\n\n[[ccr-put-auto-follow-pattern-query-params]]\n==== {api-query-parms-title}\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n\n[[ccr-put-auto-follow-pattern-request-body]]\n==== {api-request-body-title}\n\n`remote_cluster`::\n  (Required, string) The <<remote-clusters,remote cluster>> containing\n  the leader indices to match against.\n\n`leader_index_patterns`::\n  (Optional, array) An array of simple index patterns to match against indices\n  in the remote cluster specified by the `remote_cluster` field.\n\n`leader_index_exclusion_patterns`::\n  (Optional, array) An array of simple index patterns that can be used to exclude indices\n  from being auto-followed. Indices in the remote cluster whose names are matching one or\n  more `leader_index_patterns` and one or more `leader_index_exclusion_patterns` won't be followed.\n\n`follow_index_pattern`::\n  (Optional, string) The name of follower index. The template `{{leader_index}}` can be used to\n  derive the name of the follower index from the name of the leader index. When following a data\n  stream, the `follow_index_pattern` will be used for renaming not only the leader index, but also\n  the data stream containing the leader index. For example, a data stream called\n  `logs-mysql-default` with a backing index of `.ds-logs-mysql-default-2022-01-01-000001` and a\n  `follow_index_pattern` of `{{leader_index}}_copy` will replicate the data stream as\n  `logs-mysql-default_copy` and the backing index as\n  `.ds-logs-mysql-default_copy-2022-01-01-000001`.\n\ninclude::../follow-request-body.asciidoc[]\n\n[[ccr-put-auto-follow-pattern-examples]]\n==== {api-examples-title}\n\nThis example creates an auto-follow pattern named `my_auto_follow_pattern`:\n\n[source,console]\n--------------------------------------------------\nPUT /_ccr/auto_follow/my_auto_follow_pattern\n{\n  \"remote_cluster\" : \"remote_cluster\",\n  \"leader_index_patterns\" :\n  [\n    \"leader_index*\"\n  ],\n  \"follow_index_pattern\" : \"{{leader_index}}-follower\",\n  \"settings\": {\n    \"index.number_of_replicas\": 0\n  },\n  \"max_read_request_operation_count\" : 1024,\n  \"max_outstanding_read_requests\" : 16,\n  \"max_read_request_size\" : \"1024k\",\n  \"max_write_request_operation_count\" : 32768,\n  \"max_write_request_size\" : \"16k\",\n  \"max_outstanding_write_requests\" : 8,\n  \"max_write_buffer_count\" : 512,\n  \"max_write_buffer_size\" : \"512k\",\n  \"max_retry_delay\" : \"10s\",\n  \"read_poll_timeout\" : \"30s\"\n}\n--------------------------------------------------\n// TEST[setup:remote_cluster]\n\nThe API returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"acknowledged\" : true\n}\n--------------------------------------------------\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nDELETE /_ccr/auto_follow/my_auto_follow_pattern\n--------------------------------------------------\n// TEST[continued]\n\n//////////////////////////\n"
}