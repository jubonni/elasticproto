{
    "meta": {
        "timestamp": "2024-11-01T02:49:25.181067",
        "size": 4587,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/search-aggregations-metrics-geobounds-aggregation.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "search-aggregations-metrics-geobounds-aggregation",
        "version": "8.15"
    },
    "doc": "[[search-aggregations-metrics-geobounds-aggregation]]\n=== Geo-bounds aggregation\n++++\n<titleabbrev>Geo-bounds</titleabbrev>\n++++\n\nA metric aggregation that computes the geographic bounding box containing all values for a <<geo-point>> or <<geo-shape>> field.\n\nExample:\n\n[source,console]\n--------------------------------------------------\nPUT /museums\n{\n  \"mappings\": {\n    \"properties\": {\n      \"location\": {\n        \"type\": \"geo_point\"\n      }\n    }\n  }\n}\n\nPOST /museums/_bulk?refresh\n{\"index\":{\"_id\":1}}\n{\"location\": \"POINT (4.912350 52.374081)\", \"name\": \"NEMO Science Museum\"}\n{\"index\":{\"_id\":2}}\n{\"location\": \"POINT (4.901618 52.369219)\", \"name\": \"Museum Het Rembrandthuis\"}\n{\"index\":{\"_id\":3}}\n{\"location\": \"POINT (4.914722 52.371667)\", \"name\": \"Nederlands Scheepvaartmuseum\"}\n{\"index\":{\"_id\":4}}\n{\"location\": \"POINT (4.405200 51.222900)\", \"name\": \"Letterenhuis\"}\n{\"index\":{\"_id\":5}}\n{\"location\": \"POINT (2.336389 48.861111)\", \"name\": \"Mus\u00e9e du Louvre\"}\n{\"index\":{\"_id\":6}}\n{\"location\": \"POINT (2.327000 48.860000)\", \"name\": \"Mus\u00e9e d'Orsay\"}\n\nPOST /museums/_search?size=0\n{\n  \"query\": {\n    \"match\": { \"name\": \"mus\u00e9e\" }\n  },\n  \"aggs\": {\n    \"viewport\": {\n      \"geo_bounds\": {\n        \"field\": \"location\",    <1>\n        \"wrap_longitude\": true  <2>\n      }\n    }\n  }\n}\n--------------------------------------------------\n\n<1> The `geo_bounds` aggregation specifies the field to use to obtain the bounds, which must be a <<geo-point>> or a <<geo-shape>> type.\n<2> [[geo-bounds-wrap-longitude]] `wrap_longitude` is an optional parameter which specifies whether the bounding box should be allowed to overlap the international date line. The default value is `true`.\n\nThe above aggregation demonstrates how one would compute the bounding box of the location field for all documents with a name matching \"mus\u00e9e\".\n\nThe response for the above aggregation:\n\n[source,console-result]\n--------------------------------------------------\n{\n  ...\n  \"aggregations\": {\n    \"viewport\": {\n      \"bounds\": {\n        \"top_left\": {\n          \"lat\": 48.86111099738628,\n          \"lon\": 2.3269999679178\n        },\n        \"bottom_right\": {\n          \"lat\": 48.85999997612089,\n          \"lon\": 2.3363889567553997\n        }\n      }\n    }\n  }\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\\.\\.\\./\"took\": $body.took,\"_shards\": $body._shards,\"hits\":$body.hits,\"timed_out\":false,/]\n\n[discrete]\n[role=\"xpack\"]\n[[geobounds-aggregation-geo-shape]]\n==== Geo Bounds Aggregation on `geo_shape` fields\n\nThe Geo Bounds Aggregation is also supported on `geo_shape` fields.\n\nIf <<geo-bounds-wrap-longitude,`wrap_longitude`>> is set to `true`\n(the default), the bounding box can overlap the international date line and\nreturn a bounds where the `top_left` longitude is larger than the `top_right`\nlongitude.\n\nFor example, the upper right longitude will typically be greater than the lower\nleft longitude of a geographic bounding box. However, when the area\ncrosses the 180\u00b0 meridian, the value of the lower left longitude will be\ngreater than the value of the upper right longitude. See\nhttp://docs.opengeospatial.org/is/12-063r5/12-063r5.html#30[Geographic bounding box] on the Open Geospatial Consortium website for more information.\n\nExample:\n\n[source,console]\n--------------------------------------------------\nPUT /places\n{\n  \"mappings\": {\n    \"properties\": {\n      \"geometry\": {\n        \"type\": \"geo_shape\"\n      }\n    }\n  }\n}\n\nPOST /places/_bulk?refresh\n{\"index\":{\"_id\":1}}\n{\"name\": \"NEMO Science Museum\", \"geometry\": \"POINT(4.912350 52.374081)\" }\n{\"index\":{\"_id\":2}}\n{\"name\": \"Sportpark De Weeren\", \"geometry\": { \"type\": \"Polygon\", \"coordinates\": [ [ [ 4.965305328369141, 52.39347642069457 ], [ 4.966979026794433, 52.391721758934835 ], [ 4.969425201416015, 52.39238958618537 ], [ 4.967944622039794, 52.39420969150824 ], [ 4.965305328369141, 52.39347642069457 ] ] ] } }\n\nPOST /places/_search?size=0\n{\n  \"aggs\": {\n    \"viewport\": {\n      \"geo_bounds\": {\n        \"field\": \"geometry\"\n      }\n    }\n  }\n}\n--------------------------------------------------\n// TEST\n\n[source,console-result]\n--------------------------------------------------\n{\n  ...\n  \"aggregations\": {\n    \"viewport\": {\n      \"bounds\": {\n        \"top_left\": {\n          \"lat\": 52.39420966710895,\n          \"lon\": 4.912349972873926\n        },\n        \"bottom_right\": {\n          \"lat\": 52.374080987647176,\n          \"lon\": 4.969425117596984\n        }\n      }\n    }\n  }\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\\.\\.\\./\"took\": $body.took,\"_shards\": $body._shards,\"hits\":$body.hits,\"timed_out\":false,/]\n"
}