{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.312579",
        "size": 2970,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/remote-clusters-privileges-api-key.html",
        "type": "documentation",
        "role": [],
        "has_code": false,
        "title": "remote-clusters-privileges-api-key",
        "version": "8.15"
    },
    "doc": "[[remote-clusters-privileges-api-key]]\n=== Configure roles and users\n\nTo use a remote cluster for {ccr} or {ccs}, you need to create user roles with\n<<roles-remote-indices-priv,remote indices privileges>> on the local cluster.\n\nYou can manage users and roles from Stack Management in {kib} by selecting\n*Security > Roles* from the side navigation. You can also use the\n<<security-role-apis,role management APIs>> to add, update, remove, and retrieve\nroles dynamically.\n\nThe following examples use the <<security-api-put-role>> API. You must have at\nleast the `manage_security` cluster privilege to use this API.\n\nNOTE: The cross-cluster API key used by the local cluster to connect the remote\ncluster must have sufficient privileges to cover all remote indices privileges\nrequired by individual users.\n\n==== Configure privileges for {ccr}\n\nAssuming the remote cluster is connected under the name of `my_remote_cluster`,\nthe following request creates a role called `remote-replication` on the local\ncluster that allows replicating the remote `leader-index` index:\n\n[source,console]\n----\nPOST /_security/role/remote-replication\n{\n  \"cluster\": [\n    \"manage_ccr\"\n  ],\n  \"remote_indices\": [\n    {\n      \"clusters\": [ \"my_remote_cluster\" ],\n      \"names\": [\n        \"leader-index\"\n      ],\n      \"privileges\": [\n        \"cross_cluster_replication\"\n      ]\n    }\n  ]\n}\n----\n// TEST[skip:TODO]\n\nAfter creating the local `remote-replication` role, use the\n<<security-api-put-user>> API to create a user on the local cluster cluster and\nassign the `remote-replication` role. For example, the following request assigns\nthe `remote-replication` role to a user named `cross-cluster-user`:\n\n[source,console]\n----\nPOST /_security/user/cross-cluster-user\n{\n  \"password\" : \"l0ng-r4nd0m-p@ssw0rd\",\n  \"roles\" : [ \"remote-replication\" ]\n}\n----\n// TEST[skip:TODO]\n\nNote that you only need to create this user on the local cluster.\n\n==== Configure privileges for {ccs}\n\nAssuming the remote cluster is connected under the name of `my_remote_cluster`,\nthe following request creates a `remote-search` role on the local cluster that\nallows searching the remote `target-index` index:\n\n[source,console]\n----\nPOST /_security/role/remote-search\n{\n  \"remote_indices\": [\n    {\n      \"clusters\": [ \"my_remote_cluster\" ],\n      \"names\": [\n        \"target-index\"\n      ],\n      \"privileges\": [\n        \"read\",\n        \"read_cross_cluster\",\n        \"view_index_metadata\" \n      ]\n    }\n  ]\n}\n\n----\n// TEST[skip:TODO]\n\nAfter creating the `remote-search` role, use the <<security-api-put-user>> API\nto create a user on the local cluster and assign the `remote-search` role. For\nexample, the following request assigns the `remote-search` role to a user named\n`cross-search-user`:\n\n[source,console]\n----\nPOST /_security/user/cross-search-user\n{\n  \"password\" : \"l0ng-r4nd0m-p@ssw0rd\",\n  \"roles\" : [ \"remote-search\" ]\n}\n----\n// TEST[skip:TODO]\n\nNote that you only need to create this user on the local cluster.\n"
}