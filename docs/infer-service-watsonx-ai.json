{
    "meta": {
        "size": 3926,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/infer-service-watsonx-ai.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "infer-service-watsonx-ai",
        "version": "8.15"
    },
    "doc": "[[infer-service-watsonx-ai]]\n=== Watsonx {infer} service\n\nCreates an {infer} endpoint to perform an {infer} task with the `watsonxai` service.\n\nYou need an https://cloud.ibm.com/docs/databases-for-elasticsearch?topic=databases-for-elasticsearch-provisioning&interface=api[IBM Cloud\u00ae Databases for Elasticsearch deployment] to use the `watsonxai` {infer} service.\nYou can provision one through the https://cloud.ibm.com/databases/databases-for-elasticsearch/create[IBM catalog], the https://cloud.ibm.com/docs/databases-cli-plugin?topic=databases-cli-plugin-cdb-reference[Cloud Databases CLI plug-in], the https://cloud.ibm.com/apidocs/cloud-databases-api[Cloud Databases API], or https://registry.terraform.io/providers/IBM-Cloud/ibm/latest/docs/resources/database[Terraform].\n\n\n[discrete]\n[[infer-service-watsonx-ai-api-request]]\n==== {api-request-title}\n\n`PUT /_inference/<task_type>/<inference_id>`\n\n[discrete]\n[[infer-service-watsonx-ai-api-path-params]]\n==== {api-path-parms-title}\n\n`<inference_id>`::\n(Required, string)\ninclude::inference-shared.asciidoc[tag=inference-id]\n\n`<task_type>`::\n(Required, string)\ninclude::inference-shared.asciidoc[tag=task-type]\n+\n--\nAvailable task types:\n\n* `text_embedding`.\n--\n\n[discrete]\n[[infer-service-watsonx-ai-api-request-body]]\n==== {api-request-body-title}\n\n`service`::\n(Required, string)\nThe type of service supported for the specified task type. In this case, \n`watsonxai`.\n\n`service_settings`::\n(Required, object)\ninclude::inference-shared.asciidoc[tag=service-settings]\n+\n--\nThese settings are specific to the `watsonxai` service.\n--\n\n`api_key`:::\n(Required, string)\nA valid API key of your Watsonx account.\nYou can find your Watsonx API keys or you can create a new one https://cloud.ibm.com/iam/apikeys[on the API keys page].\n+\n--\ninclude::inference-shared.asciidoc[tag=api-key-admonition]\n--\n\n`api_version`:::\n(Required, string)\nVersion parameter that takes a version date in the format of `YYYY-MM-DD`.\nFor the active version data parameters, refer to the https://cloud.ibm.com/apidocs/watsonx-ai#active-version-dates[documentation].\n\n`model_id`:::\n(Required, string)\nThe name of the model to use for the {infer} task.\nRefer to the IBM Embedding Models section in the https://www.ibm.com/products/watsonx-ai/foundation-models[Watsonx documentation] for the list of available text embedding models.\n\n`url`:::\n(Required, string)\nThe URL endpoint to use for the requests.\n\n`project_id`:::\n(Required, string)\nThe name of the project to use for the {infer} task.\n\n`rate_limit`:::\n(Optional, object)\nBy default, the `watsonxai` service sets the number of requests allowed per minute to `120`.\nThis helps to minimize the number of rate limit errors returned from Watsonx.\nTo modify this, set the `requests_per_minute` setting of this object in your service settings:\n+\n--\ninclude::inference-shared.asciidoc[tag=request-per-minute-example]\n--\n\n\n[discrete]\n[[inference-example-watsonx-ai]]\n==== Watsonx AI service example\n\nThe following example shows how to create an {infer} endpoint called `watsonx-embeddings` to perform a `text_embedding` task type.\n\n[source,console]\n------------------------------------------------------------\nPUT _inference/text_embedding/watsonx-embeddings\n{\n    \"service\": \"watsonxai\",\n    \"service_settings\": {\n        \"api_key\": \"<api_key>\", <1>\n        \"url\": \"<url>\", <2>\n        \"model_id\": \"ibm/slate-30m-english-rtrvr\",\n        \"project_id\": \"<project_id>\", <3>\n        \"api_version\": \"2024-03-14\" <4>\n    }\n}\n\n------------------------------------------------------------\n// TEST[skip:TBD]\n<1> A valid Watsonx API key.\nYou can find on the https://cloud.ibm.com/iam/apikeys[API keys page of your account].\n<2> The {infer} endpoint URL you created on Watsonx.\n<3> The ID of your IBM Cloud project.\n<4> A valid API version parameter. You can find the active version data parameters https://cloud.ibm.com/apidocs/watsonx-ai#active-version-dates[here]."
}