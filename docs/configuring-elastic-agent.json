{
    "meta": {
        "timestamp": "2024-11-01T03:02:52.217578",
        "size": 3541,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/configuring-elastic-agent.html",
        "type": "documentation",
        "role": [],
        "has_code": false,
        "title": "configuring-elastic-agent",
        "version": "8.15"
    },
    "doc": "[[configuring-elastic-agent]]\n== Collecting {es} monitoring data with {agent}\n\n[subs=\"attributes\"]\n++++\n<titleabbrev>Collecting monitoring data with {agent}</titleabbrev>\n++++\n\nIn 8.5 and later, you can use {agent} to collect data about {es} and ship it to\nthe monitoring cluster, rather than <<configuring-metricbeat,using {metricbeat}>>\nor routing it through exporters as described in <<collecting-monitoring-data>>.\n\n[discrete]\n=== Prerequisites\n\n* (Optional) Create a monitoring cluster as described in <<monitoring-production>>.\n\n* Create a user on the production cluster that has the\n`remote_monitoring_collector` {ref}/built-in-roles.html[built-in role].\n\n[discrete]\n=== Add {es} monitoring data\n\nTo collect {es} monitoring data, add an {es} integration to an {agent} and\ndeploy it to the host where {es} is running.\n\n. Go to the {kib} home page and click **Add integrations**.\n. In the query bar, search for and select the **{es}** integration for\n{agent}.\n. Read the overview to make sure you understand integration requirements and\nother considerations.\n. Click **Add Elasticsearch**.\n+\nTIP: If you're installing an integration for the first time, you may be prompted\nto install {agent}. Click **Add integration only (skip agent installation)**.\n\n. Configure the integration name and optionally add a description. Make sure you\nconfigure all required settings:\n.. Under **Collect Elasticsearch logs**, modify the log paths to match your {es}\nenvironment.\n.. Under **Collect Elasticsearch metrics**, make sure the hosts setting points to\nyour {es} host URLs. By default, the integration collects {es} monitoring\nmetrics from `localhost:9200`. If that host and port number are not correct,\nupdate the `hosts` setting. If you configured {es} to use encrypted\ncommunications, you must access it via HTTPS. For example, use a `hosts` setting\nlike `https://localhost:9200`.\n.. Expand **Advanced options**. If the Elastic {security-features} are enabled,\nenter the username and password of a user that has the\n`remote_monitoring_collector` role.\n.. Specify the scope:\n** Specify `cluster` if each entry in the hosts list indicates a single\nendpoint for a distinct {es} cluster (for example, a load-balancing proxy\nfronting the cluster that directs requests to the master-ineligible nodes in the\ncluster).\n** Otherwise, accept the default scope, `node`. If this scope is set, you\nwill need to install {agent} on each {es} node to collect all metrics. {agent}\nwill collect most of the metrics from the elected master of the cluster, so you\nmust scale up all your master-eligible nodes to account for this extra load. Do\nnot use this `node` if you have dedicated master nodes.\n. Choose where to add the integration policy. Click **New hosts** to add it to\nnew agent policy or **Existing hosts** to add it to an existing agent policy.\n. Click **Save and continue**. This step takes a minute or two to complete. When\nit's done, you'll have an agent policy that contains an integration for\ncollecting monitoring data from {es}.\n. If an {agent} is already assigned to the policy and deployed to the host where\n{es} is running, you're done. Otherwise, you need to deploy an {agent}. To\ndeploy an {agent}:\n.. Go to **{fleet} -> Agents**, then click **Add agent**.\n.. Follow the steps in the **Add agent** flyout to download, install,\nand enroll the {agent}. Make sure you choose the agent policy you created\nearlier.\n. Wait a minute or two until incoming data is confirmed.\n. {kibana-ref}/monitoring-data.html[View the monitoring data in {kib}]. \n"
}