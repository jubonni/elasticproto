{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.512274",
        "size": 3780,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/update-trained-model-deployment.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "update-trained-model-deployment",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[update-trained-model-deployment]]\n= Update trained model deployment API\n\n[subs=\"attributes\"]\n++++\n<titleabbrev>Update trained model deployment</titleabbrev>\n++++\n\nUpdates certain properties of a trained model deployment.\n\n[[update-trained-model-deployment-request]]\n== {api-request-title}\n\n`POST _ml/trained_models/<deployment_id>/deployment/_update`\n\n\n[[update-trained-model-deployments-prereqs]]\n== {api-prereq-title}\n\nRequires the `manage_ml` cluster privilege. This privilege is included in the\n`machine_learning_admin` built-in role.\n\n[[update-trained-model-deployment-desc]]\n== {api-description-title}\n\nYou can update a trained model deployment whose `assignment_state` is `started`.\nYou can enable adaptive allocations to automatically scale model allocations up\nand down based on the actual resource requirement of the processes.\nOr you can manually increase or decrease the number of allocations of a model\ndeployment.\n\n\n[[update-trained-model-deployments-path-parms]]\n== {api-path-parms-title}\n\n`<deployment_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=deployment-id]\n\n[[update-trained-model-deployment-request-body]]\n== {api-request-body-title}\n\n`adaptive_allocations`::\n(Optional, object)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=adaptive-allocation]\n\n`enabled`:::\n(Optional, Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=adaptive-allocation-enabled]\n\n`max_number_of_allocations`:::\n(Optional, integer)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=adaptive-allocation-max-number]\n\n`min_number_of_allocations`:::\n(Optional, integer)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=adaptive-allocation-min-number]\n\n`number_of_allocations`::\n(Optional, integer)\nThe total number of allocations this model is assigned across {ml} nodes.\nIncreasing this value generally increases the throughput.\nIf `adaptive_allocations` is enabled, do not set this value, because it's automatically set.\n\n\n[[update-trained-model-deployment-example]]\n== {api-examples-title}\n\nThe following example updates the deployment for a\n`elastic__distilbert-base-uncased-finetuned-conll03-english` trained model to have 4 allocations:\n\n[source,console]\n--------------------------------------------------\nPOST _ml/trained_models/elastic__distilbert-base-uncased-finetuned-conll03-english/deployment/_update\n{\n  \"number_of_allocations\": 4\n}\n--------------------------------------------------\n// TEST[skip:TBD]\n\nThe API returns the following results:\n\n[source,console-result]\n----\n{\n    \"assignment\": {\n        \"task_parameters\": {\n            \"model_id\": \"elastic__distilbert-base-uncased-finetuned-conll03-english\",\n            \"model_bytes\": 265632637,\n            \"threads_per_allocation\" : 1,\n            \"number_of_allocations\" : 4,\n            \"queue_capacity\" : 1024\n        },\n        \"routing_table\": {\n            \"uckeG3R8TLe2MMNBQ6AGrw\": {\n                \"current_allocations\": 1,\n                \"target_allocations\": 4,\n                \"routing_state\": \"started\",\n                \"reason\": \"\"\n            }\n        },\n        \"assignment_state\": \"started\",\n        \"start_time\": \"2022-11-02T11:50:34.766591Z\"\n    }\n}\n----\n\nThe following example updates the deployment for a\n`elastic__distilbert-base-uncased-finetuned-conll03-english` trained model to\nenable adaptive allocations with the minimum number of 3 allocations and the\nmaximum number of 10:\n\n[source,console]\n--------------------------------------------------\nPOST _ml/trained_models/elastic__distilbert-base-uncased-finetuned-conll03-english/deployment/_update\n{\n  \"adaptive_allocations\": {\n    \"enabled\": true,\n    \"min_number_of_allocations\": 3,\n    \"max_number_of_allocations\": 10\n  }\n}\n--------------------------------------------------\n// TEST[skip:TBD]"
}