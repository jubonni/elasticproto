{
    "meta": {
        "timestamp": "2024-11-01T02:49:26.087067",
        "size": 2562,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/rejected-requests.html",
        "type": "documentation",
        "role": [],
        "has_code": false,
        "title": "rejected-requests",
        "version": "8.15"
    },
    "doc": "[[rejected-requests]]\n=== Rejected requests\n\nWhen {es} rejects a request, it stops the operation and returns an error with a\n`429` response code. Rejected requests are commonly caused by:\n\n* A <<high-cpu-usage,depleted thread pool>>. A depleted `search` or `write`\nthread pool returns a `TOO_MANY_REQUESTS` error message.\n\n* A <<circuit-breaker-errors,circuit breaker error>>.\n\n* High <<index-modules-indexing-pressure,indexing pressure>> that exceeds the\n<<memory-limits,`indexing_pressure.memory.limit`>>.\n\n[discrete]\n[[check-rejected-tasks]]\n==== Check rejected tasks\n\nTo check the number of rejected tasks for each thread pool, use the\n<<cat-thread-pool,cat thread pool API>>. A high ratio of `rejected` to\n`completed` tasks, particularly in the `search` and `write` thread pools, means\n{es} regularly rejects requests.\n\n[source,console]\n----\nGET /_cat/thread_pool?v=true&h=id,name,queue,active,rejected,completed\n----\n\n`write` thread pool rejections frequently appear in the erring API and\ncorrelating log as `EsRejectedExecutionException` with either\n`QueueResizingEsThreadPoolExecutor` or `queue capacity`.\n\nThese errors are often related to <<task-queue-backlog,backlogged tasks>>.\n\n[discrete]\n[[check-circuit-breakers]]\n==== Check circuit breakers\n\nTo check the number of tripped <<circuit-breaker,circuit breakers>>, use the\n<<cluster-nodes-stats,node stats API>>.\n\n[source,console]\n----\nGET /_nodes/stats/breaker\n----\n\nThese statistics are cumulative from node startup. For more information, see\n<<circuit-breaker,circuit breaker errors>>.\n\n[discrete]\n[[check-indexing-pressure]]\n==== Check indexing pressure\n\nTo check the number of <<index-modules-indexing-pressure,indexing pressure>>\nrejections, use the <<cluster-nodes-stats,node stats API>>.\n\n[source,console]\n----\nGET _nodes/stats?human&filter_path=nodes.*.indexing_pressure\n----\n\nThese stats are cumulative from node startup. \n\nIndexing pressure rejections appear as an\n`EsRejectedExecutionException`, and indicate that they were rejected due\nto `coordinating_and_primary_bytes`, `coordinating`, `primary`, or `replica`.\n\nThese errors are often related to <<task-queue-backlog,backlogged tasks>>,\n<<docs-bulk,bulk index>> sizing, or the ingest target's\n<<index-modules,`refresh_interval` setting>>.\n\n[discrete]\n[[prevent-rejected-requests]]\n==== Prevent rejected requests\n\n**Fix high CPU and memory usage**\n\nIf {es} regularly rejects requests and other tasks, your cluster likely has high\nCPU usage or high JVM memory pressure. For tips, see <<high-cpu-usage>> and\n<<high-jvm-memory-pressure>>."
}