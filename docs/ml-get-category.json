{
    "meta": {
        "size": 6268,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-get-category.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "ml-get-category",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ml-get-category]]\n= Get categories API\n++++\n<titleabbrev>Get categories</titleabbrev>\n++++\n\nRetrieves {anomaly-job} results for one or more categories.\n\n[[ml-get-category-request]]\n== {api-request-title}\n\n`GET _ml/anomaly_detectors/<job_id>/results/categories` +\n\n`GET _ml/anomaly_detectors/<job_id>/results/categories/<category_id>`\n\n[[ml-get-category-prereqs]]\n== {api-prereq-title}\n\nRequires the `monitor_ml` cluster privilege. This privilege is included in the \n`machine_learning_user` built-in role.\n\n[[ml-get-category-desc]]\n== {api-description-title}\n\nWhen `categorization_field_name` is specified in the job configuration, it is\npossible to view the definitions of the resulting categories. A category\ndefinition describes the common terms matched and contains examples of matched\nvalues.\n\nThe anomaly results from a categorization analysis are available as bucket,\ninfluencer, and record results. For example, the results might indicate that\nat 16:45 there was an unusual count of log message category 11. You can then\nexamine the description and examples of that category. For more information, see\n{ml-docs}/ml-configuring-categories.html[Categorizing log messages].\n\n[[ml-get-category-path-parms]]\n== {api-path-parms-title}\n\n`<job_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`<category_id>`::\n(Optional, long) Identifier for the category, which is unique in the job. If you\nspecify neither the category ID nor the `partition_field_value`, the API returns\ninformation about all categories. If you specify only the\n`partition_field_value`, it returns information about all categories for the\nspecified partition.\n\n[[ml-get-category-query-parms]]\n== {api-query-parms-title}\n\n`from`::\n(Optional, integer) Skips the specified number of categories. Defaults to `0`.\n\n`partition_field_value`::\n(Optional, string) Only return categories for the specified partition.\n\n`size`::\n(Optional, integer) Specifies the maximum number of categories to obtain. \nDefaults to `100`.\n\n\n[[ml-get-category-request-body]]\n== {api-request-body-title}\n\nYou can also specify the `partition_field_value` query parameter in the\nrequest body.\n\n`page`::\n+\n.Properties of `page`\n[%collapsible%open]\n====\n\n`from`:::\n(Optional, integer) Skips the specified number of categories. Defaults to `0`.\n\n`size`:::\n(Optional, integer) Specifies the maximum number of categories to obtain. \nDefaults to `100`.\n====\n\n[[ml-get-category-results]]\n== {api-response-body-title}\n\nThe API returns an array of category objects, which have the following properties:\n\n`category_id`::\n(unsigned integer) A unique identifier for the category. `category_id` is unique\nat the job level, even when per-partition categorization is enabled.\n\n\n`examples`::\n(array) A list of examples of actual values that matched the category.\n\n`grok_pattern`::\nexperimental[] (string) A Grok pattern that could be used in {ls} or an ingest \npipeline to extract fields from messages that match the category. This field is\nexperimental and may be changed or removed in a future release. The Grok\npatterns that are found are not optimal, but are often a good starting point for\nmanual tweaking.\n\n`job_id`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`max_matching_length`::\n(unsigned integer) The maximum length of the fields that matched the category.\nThe value is increased by 10% to enable matching for similar fields that have\nnot been analyzed.\n\n// This doesn't use the shared description because there are\n// categorization-specific aspects to its use in this context\n`partition_field_name`::\n(string) If per-partition categorization is enabled, this property identifies\nthe field used to segment the categorization. It is not present when\nper-partition categorization is disabled.\n\n`partition_field_value`::\n(string) If per-partition categorization is enabled, this property identifies\nthe value of the `partition_field_name` for the category. It is not present when\nper-partition categorization is disabled.\n\n`regex`::\n(string) A regular expression that is used to search for values that match the\ncategory.\n\n`terms`::\n(string) A space separated list of the common tokens that are matched in values\nof the category.\n\n`num_matches`::\n(long) The number of messages that have been matched by this category. This is\nonly guaranteed to have the latest accurate count after a job `_flush` or `_close`\n\n`preferred_to_categories`::\n(list) A list of `category_id` entries that this current category encompasses.\nAny new message that is processed by the categorizer will match against this\ncategory and not any of the categories in this list. This is only guaranteed\nto have the latest accurate list of categories after a job `_flush` or `_close`\n\n[[ml-get-category-example]]\n== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nGET _ml/anomaly_detectors/esxi_log/results/categories\n{\n  \"page\":{\n    \"size\": 1\n  }\n}\n--------------------------------------------------\n// TEST[skip:todo]\n\n[source,js]\n----\n{\n  \"count\": 11,\n  \"categories\": [\n    {\n      \"job_id\" : \"esxi_log\",\n      \"category_id\" : 1,\n      \"terms\" : \"Vpxa verbose vpxavpxaInvtVm opID VpxaInvtVmChangeListener Guest DiskInfo Changed\",\n      \"regex\" : \".*?Vpxa.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*\",\n      \"max_matching_length\": 154,\n      \"examples\" : [\n        \"Oct 19 17:04:44 esxi1.acme.com Vpxa: [3CB3FB90 verbose 'vpxavpxaInvtVm' opID=WFU-33d82c31] [VpxaInvtVmChangeListener] Guest DiskInfo Changed\",\n        \"Oct 19 17:04:45 esxi2.acme.com Vpxa: [3CA66B90 verbose 'vpxavpxaInvtVm' opID=WFU-33927856] [VpxaInvtVmChangeListener] Guest DiskInfo Changed\",\n        \"Oct 19 17:04:51 esxi1.acme.com Vpxa: [FFDBAB90 verbose 'vpxavpxaInvtVm' opID=WFU-25e0d447] [VpxaInvtVmChangeListener] Guest DiskInfo Changed\",\n        \"Oct 19 17:04:58 esxi2.acme.com Vpxa: [FFDDBB90 verbose 'vpxavpxaInvtVm' opID=WFU-bbff0134] [VpxaInvtVmChangeListener] Guest DiskInfo Changed\"\n      ],\n      \"grok_pattern\" : \".*?%{SYSLOGTIMESTAMP:timestamp}.+?Vpxa.+?%{BASE16NUM:field}.+?verbose.+?vpxavpxaInvtVm.+?opID.+?VpxaInvtVmChangeListener.+?Guest.+?DiskInfo.+?Changed.*\"\n    }\n  ]\n}\n----\n"
}