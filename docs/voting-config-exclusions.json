{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.547286",
        "size": 5199,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/voting-config-exclusions.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "voting-config-exclusions",
        "version": "8.15"
    },
    "doc": "[[voting-config-exclusions]]\n=== Voting configuration exclusions API\n++++\n<titleabbrev>Voting configuration exclusions</titleabbrev>\n++++\n\nAdds or removes master-eligible nodes from the\n<<modules-discovery-voting,voting configuration exclusion list>>.\n\n[[voting-config-exclusions-api-request]]\n==== {api-request-title}\n\n`POST /_cluster/voting_config_exclusions?node_names=<node_names>` +\n\n`POST /_cluster/voting_config_exclusions?node_ids=<node_ids>` +\n\n`DELETE /_cluster/voting_config_exclusions`\n\n[[voting-config-exclusions-api-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the `manage`\n<<privileges-list-cluster,cluster privilege>> to use this API.\n\n* If the <<operator-privileges,{operator-feature}>> is enabled, only operator\nusers can use this API.\n\n[[voting-config-exclusions-api-desc]]\n==== {api-description-title}\n\nBy default, if there are more than three master-eligible nodes in the cluster\nand you remove fewer than half of the master-eligible nodes in the cluster at\nonce, the <<modules-discovery-voting,voting configuration>> automatically\nshrinks.\n\nIf you want to shrink the voting configuration to contain fewer than three\nnodes or to remove half or more of the master-eligible nodes in the cluster at\nonce, use this API to remove departing nodes from the voting configuration\nmanually. The API adds an entry for each specified node to the cluster's voting\nconfiguration exclusions list. It then waits until the cluster has reconfigured\nits voting configuration to exclude the specified nodes.\n\nClusters should have no voting configuration exclusions in normal operation.\nOnce the excluded nodes have stopped, clear the voting configuration exclusions\nwith `DELETE /_cluster/voting_config_exclusions`. This API waits for the nodes\nto be fully removed from the cluster before it returns. If your cluster has\nvoting configuration exclusions for nodes that you no longer intend to remove,\nuse `DELETE /_cluster/voting_config_exclusions?wait_for_removal=false` to clear\nthe voting configuration exclusions without waiting for the nodes to leave the\ncluster.\n\nA response to `POST /_cluster/voting_config_exclusions` with an HTTP status\ncode of `200 OK` guarantees that the node has been removed from the voting\nconfiguration and will not be reinstated until the voting configuration\nexclusions are cleared by calling `DELETE /_cluster/voting_config_exclusions`.\nIf the call to `POST /_cluster/voting_config_exclusions` fails or returns a\nresponse with an HTTP status code other than `200 OK` then the node may not\nhave been removed from the voting configuration. In that case, you may safely\nretry the call.\n\nNOTE: Voting exclusions are required only when you remove at least half of the\nmaster-eligible nodes from a cluster in a short time period. They are not\nrequired when removing master-ineligible nodes or when removing fewer than half\nof the master-eligible nodes.\n\nFor more information, see <<modules-discovery-removing-nodes>>.\n\n[[voting-config-exclusions-api-query-params]]\n==== {api-query-parms-title}\n\n`node_names`::\nA comma-separated list of the names of the nodes to exclude from the voting\nconfiguration. If specified, you may not also specify `?node_ids`. Only applies\nto the `POST` form of this API.\n\n`node_ids`::\nA comma-separated list of the persistent ids of the nodes to exclude from the\nvoting configuration. If specified, you may not also specify `?node_names`.\nOnly applies to the `POST` form of this API.\n\n`timeout`::\n(Optional, <<time-units, time units>>) When adding a voting configuration\nexclusion, the API waits for the specified nodes to be excluded from the voting\nconfiguration before returning. The period of time to wait is specified by the\n`?timeout` query parameter. If the timeout expires before the appropriate\ncondition is satisfied, the request fails and returns an error. Defaults to\n`30s`. Only applies to the `POST` form of this API.\n\n`master_timeout`::\n(Optional, <<time-units, time units>>) Defines how long to wait while trying to\nroute the request to the current master node in the cluster. Defaults to `30s`.\nApplies to both `POST` and `DELETE` forms of this API.\n\n`wait_for_removal`::\n(Optional, Boolean) Specifies whether to wait for all excluded nodes to be\nremoved from the cluster before clearing the voting configuration exclusions\nlist. Defaults to `true`, meaning that all excluded nodes must be removed from\nthe cluster before this API takes any action. If set to `false` then the voting\nconfiguration exclusions list is cleared even if some excluded nodes are still\nin the cluster. Only applies to the `DELETE` form of this API.\n\n[[voting-config-exclusions-api-example]]\n==== {api-examples-title}\n\nAdds nodes named `nodeName1` and `nodeName2` to the voting configuration\nexclusions list:\n\n[source,console]\n--------------------------------------------------\nPOST /_cluster/voting_config_exclusions?node_names=nodeName1,nodeName2\n--------------------------------------------------\n\nRemove all exclusions from the list:\n\n[source,console]\n--------------------------------------------------\nDELETE /_cluster/voting_config_exclusions\n--------------------------------------------------\n"
}