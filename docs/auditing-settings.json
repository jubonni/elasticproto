{
    "meta": {
        "timestamp": "2024-11-01T03:07:08.779297",
        "size": 7889,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/auditing-settings.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": false,
        "title": "auditing-settings",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[auditing-settings]]\n=== Auditing security settings\n++++\n<titleabbrev>Auditing settings</titleabbrev>\n++++\n\n[[auditing-settings-description]]\nYou can use <<enable-audit-logging,audit logging>> to record security-related\nevents, such as authentication failures, refused connections, and data-access\nevents. In addition, changes via the APIs to the security configuration, such\nas creating, updating and removing <<native-realm, native>> and\n<<built-in-users, built-in>> users, <<security-api-put-role, roles>>,\n<<security-api-put-role-mapping, role mappings>> and\n<<security-api-create-api-key, API keys>> are also recorded.\n--\nTIP: Audit logs are only available on certain subscription levels.\nFor more information, see {subscriptions}.\n--\n\nIf configured, auditing settings must be set on every node in the cluster.\nStatic settings, such as `xpack.security.audit.enabled`, must be configured in\n`elasticsearch.yml` on each node. For dynamic auditing settings, use the\n<<cluster-update-settings,cluster update settings API>> to ensure the setting is\nthe same on all nodes.\n\n[[general-audit-settings]]\n==== General Auditing Settings\n[[xpack-security-audit-enabled]]\n// tag::xpack-security-audit-enabled-tag[]\n`xpack.security.audit.enabled`::\n(<<static-cluster-setting,Static>>)\nSet to `true` to enable auditing on the node. The default value is `false`. This\nputs the auditing events in a dedicated file named `<clustername>_audit.json` on\neach node.\n+\nIf enabled, this setting must be configured in `elasticsearch.yml` on all nodes\nin the cluster.\n// end::xpack-security-audit-enabled-tag[]\n\n[[event-audit-settings]]\n==== Audited Event Settings\n\nThe events and some other information about what gets logged can be controlled\nby using the following settings:\n\n[[xpack-sa-lf-events-include]]\n// tag::xpack-sa-lf-events-include-tag[]\n`xpack.security.audit.logfile.events.include`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies the <<audit-event-types, kind of events>> to print in the auditing output.\nIn addition, `_all` can be used to exhaustively audit all the events, but this is usually\ndiscouraged since it will get very verbose.\nThe default list value contains:\n`access_denied, access_granted, anonymous_access_denied, authentication_failed,\nconnection_denied, tampered_request, run_as_denied, run_as_granted,\nsecurity_config_change`.\n// end::xpack-sa-lf-events-include-tag[]\n\n[[xpack-sa-lf-events-exclude]]\n// tag::xpack-sa-lf-events-exclude-tag[]\n`xpack.security.audit.logfile.events.exclude`::\n(<<dynamic-cluster-setting,Dynamic>>)\nExcludes the specified <<audit-event-types, kind of events>> from the include list.\nThis is useful in the case where the `events.include` setting contains the special value `_all`.\nThe default is the empty list.\n// end::xpack-sa-lf-events-exclude-tag[]\n\n[[xpack-sa-lf-events-emit-request]]\n// tag::xpack-sa-lf-events-emit-request-tag[]\n`xpack.security.audit.logfile.events.emit_request_body`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies whether to include the full request body from REST requests as an\nattribute of certain kinds of audit events. This setting can be used to\n<<auditing-search-queries, audit search queries>>.\n+\nThe default value is `false`, so request bodies are not printed.\n+\n--\nIMPORTANT: Be advised that sensitive data may be audited in plain text when including\nthe request body in audit events, even though all the security APIs, such as those that\nchange the user's password, have the credentials filtered out when audited.\n--\n\n// end::xpack-sa-lf-events-emit-request-tag[]\n\n[[node-audit-settings]]\n==== Local Node Info Settings\n\n[[xpack-sa-lf-emit-node-name]]\n// tag::xpack-sa-lf-emit-node-name-tag[]\n`xpack.security.audit.logfile.emit_node_name`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies whether to include the <<node-name,node name>> as a field in\neach audit event. The default value is `false`.\n// end::xpack-sa-lf-emit-node-name-tag[]\n\n[[xpack-sa-lf-emit-node-host-address]]\n// tag::xpack-sa-lf-emit-node-host-address-tag[]\n`xpack.security.audit.logfile.emit_node_host_address`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies whether to include the node's IP address as a field in each audit event.\nThe default value is `false`.\n// end::xpack-sa-lf-emit-node-host-address-tag[]\n\n[[xpack-sa-lf-emit-node-host-name]]\n// tag::xpack-sa-lf-emit-node-host-name-tag[]\n`xpack.security.audit.logfile.emit_node_host_name`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies whether to include the node's host name as a field in each audit event.\nThe default value is `false`.\n// end::xpack-sa-lf-emit-node-host-name-tag[]\n\n[[xpack-sa-lf-emit-node-id]]\n// tag::xpack-sa-lf-emit-node-id-tag[]\n`xpack.security.audit.logfile.emit_node_id`::\n(<<dynamic-cluster-setting,Dynamic>>)\nSpecifies whether to include the node id as a field in each audit event.\nUnlike <<node-name,node name>>, whose value might change if the administrator\nchanges the setting in the config file, the node id will persist across cluster\nrestarts and the administrator cannot change it.\nThe default value is `true`.\n// end::xpack-sa-lf-emit-node-id-tag[]\n\n[[audit-event-ignore-policies]]\n==== Audit Logfile Event Ignore Policies\n\nThe following settings affect the <<audit-log-ignore-policy,ignore policies>>\nthat enable fine-grained control over which audit events are printed to the log file.\nAll of the settings with the same policy name combine to form a single policy.\nIf an event matches all the conditions of any policy, it is ignored and not printed.\nMost audit events are subject to the ignore policies. The sole exception are\nevents of the `security_config_change` type, which cannot be filtered out, unless\n<<xpack-sa-lf-events-exclude, excluded>> altogether.\n\n[[xpack-sa-lf-events-ignore-users]]\n// tag::xpack-sa-lf-events-ignore-users-tag[]\n`xpack.security.audit.logfile.events.ignore_filters.<policy_name>.users`::\n(<<dynamic-cluster-setting,Dynamic>>)\nA list of user names or wildcards. The specified policy will\nnot print audit events for users matching these values.\n// end::xpack-sa-lf-events-ignore-users-tag[]\n\n[[xpack-sa-lf-events-ignore-realms]]\n// tag::xpack-sa-lf-events-ignore-realms-tag[]\n`xpack.security.audit.logfile.events.ignore_filters.<policy_name>.realms`::\n(<<dynamic-cluster-setting,Dynamic>>)\nA list of authentication realm names or wildcards. The specified policy will\nnot print audit events for users in these realms.\n// end::xpack-sa-lf-events-ignore-realms-tag[]\n\n[[xpack-sa-lf-events-ignore-actions]]\n// tag::xpack-sa-lf-events-ignore-actions-tag[]\n`xpack.security.audit.logfile.events.ignore_filters.<policy_name>.actions`::\n(<<dynamic-cluster-setting,Dynamic>>)\nA list of action names or wildcards. Action name can be found in the `action`\nfield of the audit event. The specified policy will not print audit events\nfor actions matching these values.\n// end::xpack-sa-lf-events-ignore-actions-tag[]\n\n[[xpack-sa-lf-events-ignore-roles]]\n// tag::xpack-sa-lf-events-ignore-roles-tag[]\n`xpack.security.audit.logfile.events.ignore_filters.<policy_name>.roles`::\n(<<dynamic-cluster-setting,Dynamic>>)\nA list of role names or wildcards. The specified policy will\nnot print audit events for users that have these roles. If the user has several\nroles, some of which are *not* covered by the policy, the policy will\n*not* cover this event.\n// end::xpack-sa-lf-events-ignore-roles-tag[]\n\n[[xpack-sa-lf-events-ignore-indices]]\n// tag::xpack-sa-lf-events-ignore-indices-tag[]\n`xpack.security.audit.logfile.events.ignore_filters.<policy_name>.indices`::\n(<<dynamic-cluster-setting,Dynamic>>)\nA list of index names or wildcards. The specified policy will\nnot print audit events when all the indices in the event match\nthese values. If the event concerns several indices, some of which are\n*not* covered by the policy, the policy will *not* cover this event.\n// end::xpack-sa-lf-events-ignore-indices-tag[]\n"
}