{
    "meta": {
        "timestamp": "2024-11-01T03:02:52.927583",
        "size": 2136,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-migrate-to-data-stream.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": false,
        "title": "indices-migrate-to-data-stream",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[indices-migrate-to-data-stream]]\n=== Migrate to data stream API\n++++\n<titleabbrev>Migrate to data stream</titleabbrev>\n++++\n\nConverts an <<aliases,index alias>> to a <<data-streams,data stream>>.\n\n////\n[source,console]\n----\nPOST idx1/_doc/\n{\n    \"message\" : \"testing\",\n    \"@timestamp\" : \"2020-01-01\"\n}\n\nPOST idx2/_doc/\n{\n    \"message\" : \"testing2\",\n    \"@timestamp\" : \"2020-01-01\"\n}\n\nPOST /_aliases\n{\n  \"actions\": [\n    {\n      \"add\": {\n        \"index\": \"idx1\",\n        \"alias\": \"my-logs\",\n        \"is_write_index\": true\n      }\n    },\n    {\n      \"add\": {\n        \"index\": \"idx2\",\n        \"alias\": \"my-logs\"\n      }\n    }\n  ]\n}\n\nPUT /_index_template/template\n{\n  \"index_patterns\": [\"my-logs*\"],\n  \"data_stream\": { }\n}\n----\n////\n\n[source,console]\n----\nPOST /_data_stream/_migrate/my-logs\n----\n// TEST[continued]\n\n////\n[source,console]\n-----------------------------------\nDELETE /_data_stream/my-logs\nDELETE /_index_template/template\n-----------------------------------\n// TEST[continued]\n////\n\n[[indices-migrate-to-data-stream-request]]\n==== {api-request-title}\n\n`POST /_data_stream/_migrate/<alias>`\n\n[[indices-migrate-to-data-stream-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the `manage`\n<<privileges-list-indices,index privilege>> for the index alias.\n\n* A matching <<index-templates,index template>> with data stream enabled.\nSee <<set-up-a-data-stream>>.\n\n[[indices-migrate-to-data-stream-api-path-params]]\n==== {api-path-parms-title}\n\n`<alias>`::\n+\n--\n(Required, string)\nName of the index alias to convert to a data stream. The alias must meet the\nfollowing criteria:\n\n- The alias must have a <<write-index,write index>>.\n- All indices for the alias have a `@timestamp` field mapping of a `date` or `date_nanos` field type.\n- The alias must not have any <<filter-alias,filters>>.\n- The alias must not use <<alias-routing,custom routing>>.\n\nIf successful, the request removes the alias and creates a data stream with the\nsame name. The alias's indices become hidden backing indices for the stream. The\nalias's write index becomes the stream's write index.\n--\n"
}