{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.546581",
        "size": 3216,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/simulate-multi-component-templates.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "simulate-multi-component-templates",
        "version": "8.15"
    },
    "doc": "[[simulate-multi-component-templates]]\n== Simulate multi-component templates\n\nSince templates can be composed not only of multiple component templates, but also the index\ntemplate itself, there are two simulation APIs to determine what the resulting index settings will\nbe.\n\nTo simulate the settings that would be applied to a particular index name:\n\n////\n[source,console]\n--------------------------------------------------\nPUT /_index_template/template_1\n{\n  \"index_patterns\" : [\"my*\"],\n  \"priority\" : 1,\n  \"template\": {\n    \"settings\" : {\n      \"number_of_shards\" : 2\n    }\n  }\n}\n--------------------------------------------------\n// TESTSETUP\n\n[source,console]\n--------------------------------------------------\nDELETE /_index_template/template_1\n--------------------------------------------------\n// TEARDOWN\n\n////\n\n[source,console]\n--------------------------------------------------\nPOST /_index_template/_simulate_index/my-index-000001\n--------------------------------------------------\n\nTo simulate the settings that would be applied from an existing template:\n\n[source,console]\n--------------------------------------------------\nPOST /_index_template/_simulate/template_1\n--------------------------------------------------\n\nYou can also specify a template definition in the simulate request. \nThis enables you to verify that settings will be applied as expected before you add a new template.\n\n[source,console]\n--------------------------------------------------\nPUT /_component_template/ct1 \n{\n  \"template\": {\n    \"settings\": {\n      \"index.number_of_shards\": 2\n    }\n  }\n}\n\nPUT /_component_template/ct2 \n{\n  \"template\": {\n    \"settings\": {\n      \"index.number_of_replicas\": 0\n    },\n    \"mappings\": {\n      \"properties\": {\n        \"@timestamp\": {\n          \"type\": \"date\"\n        }\n      }\n    }\n  }\n}\n\nPOST /_index_template/_simulate\n{\n  \"index_patterns\": [\"my*\"],\n  \"template\": {\n    \"settings\" : {\n        \"index.number_of_shards\" : 3\n    }\n  },\n  \"composed_of\": [\"ct1\", \"ct2\"]\n}\n--------------------------------------------------\n\n\nThe response shows the settings, mappings, and aliases that would be applied to matching indices,\nand any overlapping templates whose configuration would be superseded by the simulated template body \nor higher-priority templates.\n\n[source,console-result]\n---------------------------------------------------------\n{\n  \"template\" : {\n    \"settings\" : {\n      \"index\" : {\n        \"number_of_shards\" : \"3\",   <1>\n        \"number_of_replicas\" : \"0\",\n        \"routing\" : {\n          \"allocation\" : {\n            \"include\" : {\n              \"_tier_preference\" : \"data_content\"\n            }\n          }\n        }\n      }\n    },\n    \"mappings\" : {\n      \"properties\" : {\n        \"@timestamp\" : {\n          \"type\" : \"date\"           <2>\n        }\n      }\n    },\n    \"aliases\" : { }\n  },\n  \"overlapping\" : [\n    {\n      \"name\" : \"template_1\",        <3>\n      \"index_patterns\" : [\n        \"my*\"\n      ]\n    }\n  ]\n}\n---------------------------------------------------------\n<1> The number of shards from the simulated template body\n<2> The `@timestamp` field inherited from the `ct2` component template\n<3> Any overlapping templates that would have matched, but have lower priority\n"
}