{
    "meta": {
        "timestamp": "2024-11-01T02:49:24.506068",
        "size": 10019,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-analyze.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "indices-analyze",
        "version": "8.15"
    },
    "doc": "[[indices-analyze]]\n=== Analyze API\n++++\n<titleabbrev>Analyze</titleabbrev>\n++++\n\nPerforms <<analysis,analysis>> on a text string\nand returns the resulting tokens.\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"analyzer\" : \"standard\",\n  \"text\" : \"Quick Brown Foxes!\"\n}\n--------------------------------------------------\n\n\n[[analyze-api-request]]\n==== {api-request-title}\n\n`GET /_analyze`\n\n`POST /_analyze`\n\n`GET /<index>/_analyze`\n\n`POST /<index>/_analyze`\n\n[[analyze-api-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the `manage`\n<<privileges-list-indices,index privilege>> for the specified index.\n\n[[analyze-api-path-params]]\n==== {api-path-parms-title}\n\n`<index>`::\n+\n--\n(Optional, string)\nIndex used to derive the analyzer.\n\nIf specified,\nthe `analyzer` or `<field>` parameter overrides this value.\n\nIf no analyzer or field are specified,\nthe analyze API uses the default analyzer for the index.\n\nIf no index is specified\nor the index does not have a default analyzer,\nthe analyze API uses the <<analysis-standard-analyzer,standard analyzer>>.\n--\n\n\n[[analyze-api-query-params]]\n==== {api-query-parms-title}\n\n`analyzer`::\n+\n--\n(Optional, string)\nThe name of the analyzer that should be applied to the provided `text`. This could be a\n<<analysis-analyzers, built-in analyzer>>, or an analyzer that's been configured in the index.\n\nIf this parameter is not specified,\nthe analyze API uses the analyzer defined in the field's mapping.\n\nIf no field is specified,\nthe analyze API uses the default analyzer for the index.\n\nIf no index is specified,\nor the index does not have a default analyzer,\nthe analyze API uses the <<analysis-standard-analyzer,standard analyzer>>.\n--\n\n`attributes`::\n(Optional, array of strings)\nArray of token attributes used to filter the output of the `explain` parameter.\n\n`char_filter`::\n(Optional, array of strings)\nArray of character filters used to preprocess characters before the tokenizer.\nSee <<analysis-charfilters>> for a list of character filters.\n\n`explain`::\n(Optional, Boolean)\nIf `true`, the response includes token attributes and additional details.\nDefaults to `false`.\nexperimental:[The format of the additional detail information is labelled as experimental in Lucene and it may change in the future.]\n\n`field`::\n+\n--\n(Optional, string)\nField used to derive the analyzer.\nTo use this parameter,\nyou must specify an index.\n\nIf specified,\nthe `analyzer` parameter overrides this value.\n\nIf no field is specified,\nthe analyze API uses the default analyzer for the index.\n\nIf no index is specified\nor the index does not have a default analyzer,\nthe analyze API uses the <<analysis-standard-analyzer,standard analyzer>>.\n--\n\n`filter`::\n(Optional, Array of strings)\nArray of token filters used to apply after the tokenizer.\nSee <<analysis-tokenfilters>> for a list of token filters.\n\n`normalizer`::\n(Optional, string)\nNormalizer to use to convert text into a single token.\nSee <<analysis-normalizers>> for a list of normalizers.\n\n`text`::\n(Required, string or array of strings)\nText to analyze.\nIf an array of strings is provided, it is analyzed as a multi-value field.\n\n`tokenizer`::\n(Optional, string)\nTokenizer to use to convert text into tokens.\nSee <<analysis-tokenizers>> for a list of tokenizers.\n\n[[analyze-api-example]]\n==== {api-examples-title}\n\n[[analyze-api-no-index-ex]]\n===== No index specified\n\nYou can apply any of the built-in analyzers to the text string without\nspecifying an index.\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"analyzer\" : \"standard\",\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n\n[[analyze-api-text-array-ex]]\n===== Array of text strings\n\nIf the `text` parameter is provided as array of strings, it is analyzed as a multi-value field.\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"analyzer\" : \"standard\",\n  \"text\" : [\"this is a test\", \"the second text\"]\n}\n--------------------------------------------------\n\n[[analyze-api-custom-analyzer-ex]]\n===== Custom analyzer\n\nYou can use the analyze API to test a custom transient analyzer built from\ntokenizers, token filters, and char filters. Token filters use the `filter`\nparameter:\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"tokenizer\" : \"keyword\",\n  \"filter\" : [\"lowercase\"],\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"tokenizer\" : \"keyword\",\n  \"filter\" : [\"lowercase\"],\n  \"char_filter\" : [\"html_strip\"],\n  \"text\" : \"this is a <b>test</b>\"\n}\n--------------------------------------------------\n\nCustom tokenizers, token filters, and character filters can be specified in the request body as follows:\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"tokenizer\" : \"whitespace\",\n  \"filter\" : [\"lowercase\", {\"type\": \"stop\", \"stopwords\": [\"a\", \"is\", \"this\"]}],\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n\n[[analyze-api-specific-index-ex]]\n===== Specific index\n\nYou can also run the analyze API against a specific index:\n\n[source,console]\n--------------------------------------------------\nGET /analyze_sample/_analyze\n{\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n// TEST[setup:analyze_sample]\n\nThe above will run an analysis on the \"this is a test\" text, using the\ndefault index analyzer associated with the `analyze_sample` index. An `analyzer`\ncan also be provided to use a different analyzer:\n\n[source,console]\n--------------------------------------------------\nGET /analyze_sample/_analyze\n{\n  \"analyzer\" : \"whitespace\",\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n// TEST[setup:analyze_sample]\n\n[[analyze-api-field-ex]]\n===== Derive analyzer from a field mapping\n\nThe analyzer can be derived based on a field mapping, for example:\n\n[source,console]\n--------------------------------------------------\nGET /analyze_sample/_analyze\n{\n  \"field\" : \"obj1.field1\",\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n// TEST[setup:analyze_sample]\n\nWill cause the analysis to happen based on the analyzer configured in the\nmapping for `obj1.field1` (and if not, the default index analyzer).\n\n[[analyze-api-normalizer-ex]]\n===== Normalizer\n\nA `normalizer` can be provided for keyword field with normalizer associated with the `analyze_sample` index.\n\n[source,console]\n--------------------------------------------------\nGET /analyze_sample/_analyze\n{\n  \"normalizer\" : \"my_normalizer\",\n  \"text\" : \"BaR\"\n}\n--------------------------------------------------\n// TEST[setup:analyze_sample]\n\nOr by building a custom transient normalizer out of token filters and char filters.\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"filter\" : [\"lowercase\"],\n  \"text\" : \"BaR\"\n}\n--------------------------------------------------\n\n[[explain-analyze-api]]\n===== Explain analyze\n\nIf you want to get more advanced details, set `explain` to `true` (defaults to `false`). It will output all token attributes for each token.\nYou can filter token attributes you want to output by setting `attributes` option.\n\nNOTE: The format of the additional detail information is labelled as experimental in Lucene and it may change in the future.\n\n[source,console]\n--------------------------------------------------\nGET /_analyze\n{\n  \"tokenizer\" : \"standard\",\n  \"filter\" : [\"snowball\"],\n  \"text\" : \"detailed output\",\n  \"explain\" : true,\n  \"attributes\" : [\"keyword\"] <1>\n}\n--------------------------------------------------\n\n<1> Set \"keyword\" to output \"keyword\" attribute only\n\nThe request returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"detail\" : {\n    \"custom_analyzer\" : true,\n    \"charfilters\" : [ ],\n    \"tokenizer\" : {\n      \"name\" : \"standard\",\n      \"tokens\" : [ {\n        \"token\" : \"detailed\",\n        \"start_offset\" : 0,\n        \"end_offset\" : 8,\n        \"type\" : \"<ALPHANUM>\",\n        \"position\" : 0\n      }, {\n        \"token\" : \"output\",\n        \"start_offset\" : 9,\n        \"end_offset\" : 15,\n        \"type\" : \"<ALPHANUM>\",\n        \"position\" : 1\n      } ]\n    },\n    \"tokenfilters\" : [ {\n      \"name\" : \"snowball\",\n      \"tokens\" : [ {\n        \"token\" : \"detail\",\n        \"start_offset\" : 0,\n        \"end_offset\" : 8,\n        \"type\" : \"<ALPHANUM>\",\n        \"position\" : 0,\n        \"keyword\" : false <1>\n      }, {\n        \"token\" : \"output\",\n        \"start_offset\" : 9,\n        \"end_offset\" : 15,\n        \"type\" : \"<ALPHANUM>\",\n        \"position\" : 1,\n        \"keyword\" : false <1>\n      } ]\n    } ]\n  }\n}\n--------------------------------------------------\n\n<1> Output only \"keyword\" attribute, since specify \"attributes\" in the request.\n\n[[tokens-limit-settings]]\n===== Setting a token limit\nGenerating excessive amount of tokens may cause a node to run out of memory.\nThe following setting allows to limit the number of tokens that can be produced:\n\n`index.analyze.max_token_count`::\n    The maximum number of tokens that can be produced using `_analyze` API.\n    The default value is `10000`. If more than this limit of tokens gets\n    generated, an error will be thrown. The `_analyze` endpoint without a specified\n    index will always use `10000` value as a limit. This setting allows you to control\n    the limit for a specific index:\n\n\n[source,console]\n--------------------------------------------------\nPUT /analyze_sample\n{\n  \"settings\" : {\n    \"index.analyze.max_token_count\" : 20000\n  }\n}\n--------------------------------------------------\n\n\n[source,console]\n--------------------------------------------------\nGET /analyze_sample/_analyze\n{\n  \"text\" : \"this is a test\"\n}\n--------------------------------------------------\n// TEST[setup:analyze_sample]\n"
}