{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.132286",
        "size": 4415,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-saml-invalidate.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "security-api-saml-invalidate",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[security-api-saml-invalidate]]\n=== SAML invalidate API\n++++\n<titleabbrev>SAML invalidate</titleabbrev>\n++++\n\nSubmits a SAML LogoutRequest message to {es} for consumption.\n\nNOTE: This API is intended for use by custom web applications other than {kib}.\nIf you are using {kib}, see the <<saml-guide-stack>>.\n\n[[security-api-saml-invalidate-request]]\n==== {api-request-title}\n\n`POST /_security/saml/invalidate`\n\n[[security-api-saml-invalidate-desc]]\n==== {api-description-title}\n\nThe logout request comes from the SAML IdP during an IdP initiated Single Logout.\nThe custom web application can use this API to have {es} process the `LogoutRequest`.\nAfter successful validation of the request, {es} invalidates the access token\nand refresh token that corresponds to that specific SAML principal and provides\na URL that contains a SAML LogoutResponse message, so that the user can be\nredirected back to their IdP.\n\n{es} exposes all the necessary SAML related functionality via the SAML APIs.\nThese APIs are used internally by {kib} in order to provide SAML based\nauthentication, but can also be used by other custom web applications or other\nclients. See also <<security-api-saml-authenticate,SAML authenticate API>>,\n<<security-api-saml-prepare-authentication,SAML prepare authentication API>>,\n<<security-api-saml-logout,SAML logout API>>, and\n<<security-api-saml-complete-logout, SAML complete logout API>>.\n\n[[security-api-saml-invalidate-request-body]]\n==== {api-request-body-title}\n\n`acs`::\n  (Optional, string) The Assertion Consumer Service URL that matches the one of the SAML\n  realm in {es} that should be used. You must specify either this parameter or the `realm` parameter.\n\n`query_string`::\n  (Required, string) The query part of the URL that the user was redirected to by the SAML\n  IdP to initiate the Single Logout. This query should include a single\n  parameter named `SAMLRequest` that contains a SAML logout request that is\n  deflated and Base64 encoded. If the SAML IdP has signed the logout request,\n  the URL should include two extra parameters named `SigAlg` and `Signature`\n  that contain the algorithm used for the signature and the signature value itself.\nIn order for {es} to be able to verify the IdP's signature, the value of the query_string field must be an exact match to the string provided by the browser.\nThe client application must not attempt to parse or process the string in any way.\n\n`queryString`::\ndeprecated:[7.14.0, \"Use query_string instead\"]\n  See `query_string`.\n\n`realm`::\n  (Optional, string) The name of the SAML realm in {es} the configuration. You must specify\n  either this parameter or the `acs` parameter.\n\n[[security-api-saml-invalidate-response-body]]\n==== {api-response-body-title}\n\n`invalidated`::\n  (integer) The number of tokens that were invalidated as part of this logout.\n\n`realm`::\n  (string) The realm name of the SAML realm in {es} that authenticated the user.\n\n`redirect`::\n  (string) A SAML logout response as a parameter so that the user can be\n  redirected back to the SAML IdP.\n\n\n[[security-api-saml-invalidate-example]]\n==== {api-examples-title}\n\nThe following example invalidates all the tokens for realm `saml1` pertaining to\nthe user that is identified in the SAML Logout Request:\n\n[source,console]\n--------------------------------------------------\nPOST /_security/saml/invalidate\n{\n  \"query_string\" : \"SAMLRequest=nZFda4MwFIb%2FiuS%2BmviRpqFaClKQdbvo2g12M2KMraCJ9cRR9utnW4Wyi13sMie873MeznJ1aWrnS3VQGR0j4mLkKC1NUeljjA77zYyhVbIE0dR%2By7fmaHq7U%2BdegXWGpAZ%2B%2F4pR32luBFTAtWgUcCv56%2Fp5y30X87Yz1khTIycdgpUW9kY7WdsC9zxoXTvMvWuVV98YyMnSGH2SYE5pwALBIr9QKiwDGpW0oGVUznGeMyJZKFkQ4jBf5HnhUymjIhzCAL3KNFihbYx8TBYzzGaY7EnIyZwHzCWMfiDnbRIftkSjJr%2BFu0e9v%2B0EgOquRiiZjKpiVFp6j50T4WXoyNJ%2FEWC9fdqc1t%2F1%2B2F3aUpjzhPiXpqMz1%2FHSn4A&SigAlg=http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmldsig-more%23rsa-sha256&Signature=MsAYz2NFdovMG2mXf6TSpu5vlQQyEJAg%2B4KCwBqJTmrb3yGXKUtIgvjqf88eCAK32v3eN8vupjPC8LglYmke1ZnjK0%2FKxzkvSjTVA7mMQe2AQdKbkyC038zzRq%2FYHcjFDE%2Bz0qISwSHZY2NyLePmwU7SexEXnIz37jKC6NMEhus%3D\",\n  \"realm\" : \"saml1\"\n}\n--------------------------------------------------\n// TEST[skip:handled in IT]\n\n[source,js]\n--------------------------------------------------\n{\n  \"redirect\" : \"https://my-idp.org/logout/SAMLResponse=....\",\n  \"invalidated\" : 2,\n  \"realm\" : \"saml1\"\n}\n--------------------------------------------------\n// NOTCONSOLE\n"
}