{
    "meta": {
        "size": 6138,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/configuring-filebeat.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "configuring-filebeat",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[configuring-filebeat]]\n== Collecting {es} log data with {filebeat}\n\n[subs=\"attributes\"]\n++++\n<titleabbrev>Collecting log data with {filebeat}</titleabbrev>\n++++\n\nYou can use {filebeat} to monitor the {es} log files, collect log events, and\nship them to the monitoring cluster. Your recent logs are visible on the\n*Monitoring* page in {kib}.\n\nIMPORTANT: If you're using {agent}, do not deploy {filebeat} for log collection.\nInstead, configure the {es} integration to collect logs.\n\n//NOTE: The tagged regions are re-used in the Stack Overview.\n\n. Verify that {es} is running and that the monitoring cluster is ready to\nreceive data from {filebeat}.\n+\n--\nTIP: In production environments, we strongly recommend using a separate cluster \n(referred to as the _monitoring cluster_) to store the data. Using a separate \nmonitoring cluster prevents production cluster outages from impacting your \nability to access your monitoring data. It also prevents monitoring activities \nfrom impacting the performance of your production cluster. See\n<<monitoring-production>>.\n\n--\n\n. Identify which logs you want to monitor. \n+\n--\nThe {filebeat} {es} module can handle\n<<audit-log-output,audit logs>>,\n<<deprecation-logging,deprecation logs>>,\n<<gc-logging,gc logs>>, <<logging,server logs>>, and \n<<index-modules-slowlog,slow logs>>.\nFor more information about the location of your {es} logs, see the\n<<path-settings,path.logs>> setting.\n\nIMPORTANT: If there are both structured (`*.json`) and unstructured (plain text)\nversions of the logs, you must use the structured logs. Otherwise, they might\nnot appear in the appropriate context in {kib}.\n\n--\n\n. {filebeat-ref}/filebeat-installation-configuration.html[Install {filebeat}] on the {es}\nnodes that contain logs that you want to monitor.\n\n. Identify where to send the log data.\n+\n--\n// tag::output-elasticsearch[]\nFor example, specify {es} output information for your monitoring cluster in\nthe {filebeat} configuration file (`filebeat.yml`):\n\n[source,yaml]\n----------------------------------\noutput.elasticsearch:\n  # Array of hosts to connect to.\n  hosts: [\"http://es-mon-1:9200\", \"http://es-mon-2:9200\"] <1>\n\n  # Optional protocol and basic auth credentials.\n  #protocol: \"https\"\n  #username: \"elastic\"\n  #password: \"changeme\"\n----------------------------------\n<1> In this example, the data is stored on a monitoring cluster with nodes \n`es-mon-1` and `es-mon-2`. \n\nIf you configured the monitoring cluster to use encrypted communications, you\nmust access it via HTTPS. For example, use a `hosts` setting like\n`https://es-mon-1:9200`.\n\nIMPORTANT: The {es} {monitor-features} use ingest pipelines, therefore the\ncluster that stores the monitoring data must have at least one \n<<ingest,ingest node>>.\n \nIf {es} {security-features} are enabled on the monitoring cluster, you must\nprovide a valid user ID and password so that {filebeat} can send metrics \nsuccessfully. \n\nFor more information about these configuration options, see \n{filebeat-ref}/elasticsearch-output.html[Configure the {es} output].\n// end::output-elasticsearch[]\n--\n\n. Optional: Identify where to visualize the data.\n+\n--\n// tag::setup-kibana[]\n{filebeat} provides example {kib} dashboards, visualizations and searches. To\nload the dashboards into the appropriate {kib} instance, specify the\n`setup.kibana` information in the {filebeat} configuration file\n(`filebeat.yml`) on each node:\n\n[source,yaml]\n----------------------------------\nsetup.kibana:\n  host: \"localhost:5601\"\n  #username: \"my_kibana_user\"\n  #password: \"YOUR_PASSWORD\"\n----------------------------------\n\nTIP: In production environments, we strongly recommend using a dedicated {kib} \ninstance for your monitoring cluster.\n\nIf {security-features} are enabled, you must provide a valid user ID and\npassword so that {filebeat} can connect to {kib}: \n\n.. Create a user on the monitoring cluster that has the \n<<built-in-roles,`kibana_admin` built-in role>> or equivalent\nprivileges.\n\n.. Add the `username` and `password` settings to the {es} output information in \nthe {filebeat} configuration file. The example shows a hard-coded password, but\nyou should store sensitive values in the\n{filebeat-ref}/keystore.html[secrets keystore].\n\nSee {filebeat-ref}/setup-kibana-endpoint.html[Configure the {kib} endpoint].\n\n// end::setup-kibana[]\n--\n\n. Enable the {es} module and set up the initial {filebeat} environment on each\nnode.\n+\n--\n// tag::enable-es-module[]\nFor example:\n\n[\"source\",\"sh\",subs=\"attributes,callouts\"]\n----------------------------------------------------------------------\nfilebeat modules enable elasticsearch\nfilebeat setup -e\n----------------------------------------------------------------------\n\nFor more information, see  \n{filebeat-ref}/filebeat-module-elasticsearch.html[{es} module]. \n\n// end::enable-es-module[]\n--\n\n. Configure the {es} module in {filebeat} on each node.\n+\n--\n// tag::configure-es-module[]\nIf the logs that you want to monitor aren't in the default location, set the\nappropriate path variables in the `modules.d/elasticsearch.yml` file. See\n{filebeat-ref}/filebeat-module-elasticsearch.html#configuring-elasticsearch-module[Configure the {es} module].\n\nIMPORTANT: If there are JSON logs, configure the `var.paths` settings to point\nto them instead of the plain text logs.\n\n// end::configure-es-module[]\n--\n\n. {filebeat-ref}/filebeat-starting.html[Start {filebeat}] on each node. \n+\n--\nNOTE: Depending on how you\u2019ve installed {filebeat}, you might see errors related\nto file ownership or permissions when you try to run {filebeat} modules. See\n{beats-ref}/config-file-permissions.html[Config file ownership and permissions].\n\n--\n\n. Check whether the appropriate indices exist on the monitoring cluster.\n+\n--\nFor example, use the <<cat-indices,cat indices>> command to verify\nthat there are new `filebeat-*` indices. \n\nTIP: If you want to use the *Monitoring* UI in {kib}, there must also be \n`.monitoring-*` indices. Those indices are generated when you collect metrics\nabout {stack} products. For example, see <<configuring-metricbeat>>.\n\n--\n\n. {kibana-ref}/monitoring-data.html[View the monitoring data in {kib}].\n"
}