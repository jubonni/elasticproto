{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.206582",
        "size": 9202,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/preview-transform.html",
        "type": "documentation",
        "role": [
            "xpack",
            "child_attributes",
            "child_attributes"
        ],
        "has_code": true,
        "title": "preview-transform",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[preview-transform]]\n= Preview {transform} API\n\n[subs=\"attributes\"]\n++++\n<titleabbrev>Preview {transform}</titleabbrev>\n++++\n\nPreviews a {transform}.\n\n[[preview-transform-request]]\n== {api-request-title}\n\n\n`GET _transform/<transform_id>/_preview` +\n\n`POST _transform/<transform_id>/_preview` +\n\n`GET _transform/_preview` +\n\n`POST _transform/_preview`\n\n\n[[preview-transform-prereq]]\n== {api-prereq-title}\n\nRequires the following privileges:\n\n* cluster: `manage_transform` (the `transform_admin` built-in role grants this\n  privilege)\n* source indices: `read`, `view_index_metadata`.\n\n[[preview-transform-desc]]\n== {api-description-title}\n\nThis API generates a preview of the results that you will get when you run the\n<<put-transform,create {transforms} API>> with the same\nconfiguration. It returns a maximum of 100 results. The calculations are based\non all the current data in the source index.\n\nIt also generates a list of mappings and settings for the destination index.\nIf the destination index does not exist when you start a {transform}, these are\nthe mappings and settings that are used. These values are determined based on\nthe field types of the source index and the {transform} aggregations.\n\nTIP: There are some <<transform-aggresponse-limitations,limitations>> that\nmight result in poor mappings. As a work-around, create the destination index\nor an index template with your preferred mappings before you start the\n{transform}.\n\nYou must choose either the `latest` or `pivot` method for your {transform}; you\ncannot use both in a single {transform}.\n\nIMPORTANT: When you preview a {transform}, it uses the credentials of the user\ncalling the API. When you start a {transform}, it uses the roles of the last\nuser to create or update it. If the two sets of roles differ, the preview may\nnot accurately reflect the behavior of the {transform}. To avoid such problems,\nthe same user that creates or updates the {transform} should preview it to\nensure it is returning the expected data. Alternatively, use\n<<http-clients-secondary-authorization,secondary authorization headers>> to\nsupply the credentials\n\n[role=\"child_attributes\"]\n\n[[preview-transform-path-params]]\n== {api-path-parms-title}\n\n`<transform_id>`::\n(Optional, string)\nId of the {transform} to preview.\n+\nNOTE: If you provide the `<transform_id>` as a path parameter, you cannot\nprovide {transform} configuration details in the request body.\n\n[[preview-transform-query-parms]]\n== {api-query-parms-title}\n\n`timeout`::\n(Optional, time)\nPeriod to wait for a response. If no response is received before the timeout\nexpires, the request fails and returns an error. Defaults to `30s`.\n\n[[preview-transform-request-body]]\n== {api-request-body-title}\n\n\n`description`::\n(Optional, string) Free text description of the {transform}.\n\n//Begin dest\n`dest`::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=dest]\n+\n.Properties of `dest`\n[%collapsible%open]\n====\n`index`:::\n(Optional, string)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=dest-index]\n\n`pipeline`:::\n(Optional, string)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=dest-pipeline]\n====\n//End dest\n\n`frequency`::\n(Optional, <<time-units, time units>>)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=frequency]\n\n//Begin latest\n`latest`::\n(Required^*^, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-latest]\n+\n.Properties of `latest`\n[%collapsible%open]\n====\n\n`sort`:::\n(Required, string)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-sort]\n\n`unique_key`:::\n(Required, array of strings)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-unique-key]\n\n====\n//End latest\n\n//Begin pivot\n`pivot`::\n(Required, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=pivot]\n+\n.Properties of `pivot`\n[%collapsible%open]\n====\n`aggregations` or `aggs`:::\n(Required, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=pivot-aggs]\n\n`group_by`:::\n(Required, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=pivot-group-by]\n====\n//End pivot\n\n//Begin retention policy\n`retention_policy`::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-retention]\n+\n.Properties of `retention_policy`\n[%collapsible%open]\n====\n`time`:::\n(Required, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-retention-time]\n+\n.Properties of `time`\n[%collapsible%open]\n=====\n`field`:::\n(Required, string)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-retention-time-field]\n\n`max_age`:::\n(Required, <<time-units, time units>>)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-retention-time-max-age]\n=====\n====\n//End retention policy\n\n//Begin source\n`source`::\n(Required, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=source-transforms]\n+\n.Properties of `source`\n[%collapsible%open]\n====\n`index`:::\n(Required, string or array)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=source-index-transforms]\n\n`query`:::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=source-query-transforms]\n\n`runtime_mappings`:::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=source-runtime-mappings-transforms]\n====\n//End source\n\n//Begin sync\n`sync`::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=sync]\n+\n.Properties of `sync`\n[%collapsible%open]\n====\n//Begin sync.time\n\n`time`:::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=sync-time]\n+\n.Properties of `time`\n[%collapsible%open]\n=====\n`delay`::::\n(Optional, <<time-units, time units>>)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=sync-time-delay]\n\n`field`::::\n(Optional, string)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=sync-time-field]\n=====\n//End sync.time\n====\n//End sync\n\n//Begin settings\n`settings`::\n(Optional, object)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings]\n+\n.Properties of `settings`\n[%collapsible%open]\n====\n`align_checkpoints`:::\n(Optional, boolean)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-align-checkpoints]\n`dates_as_epoch_millis`:::\n(Optional, boolean)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-dates-as-epoch-milli]\n`deduce_mappings`:::\n(Optional, boolean)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-deduce-mappings]\n`docs_per_second`:::\n(Optional, float)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-docs-per-second]\n`max_page_search_size`:::\n(Optional, integer)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-max-page-search-size]\n`unattended`:::\n(Optional, boolean)\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=transform-settings-unattended]\n====\n//End settings\n\n[role=\"child_attributes\"]\n[[preview-transform-response]]\n== {api-response-body-title}\n\n\n//Begin generated_dest_index\n`generated_dest_index`::\n(object) Contains details about the destination index.\n+\n.Properties of `generated_dest_index`\n[%collapsible%open]\n====\n\n`aliases`:::\n(object) The aliases for the destination index.\n\n`mappings`:::\n(object) The <<mapping,mappings>> for each document in the destination index.\n\n`settings`:::\n(object) The <<index-modules-settings,index settings>> for the destination index.\n====\n//End generated_dest_index\n\n`preview`::\n(array) An array of documents. In particular, they are the JSON representation\nof the documents that would be created in the destination index by the\n{transform}.\n\n\n== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nPOST _transform/_preview\n{\n  \"source\": {\n    \"index\": \"kibana_sample_data_ecommerce\"\n  },\n  \"pivot\": {\n    \"group_by\": {\n      \"customer_id\": {\n        \"terms\": {\n          \"field\": \"customer_id\",\n          \"missing_bucket\": true\n        }\n      }\n    },\n    \"aggregations\": {\n      \"max_price\": {\n        \"max\": {\n          \"field\": \"taxful_total_price\"\n        }\n      }\n    }\n  }\n}\n--------------------------------------------------\n// TEST[skip:set up sample data]\n\nThe data that is returned for this example is as follows:\n[source,js]\n----\n{\n  \"preview\" : [\n    {\n      \"max_price\" : 171.0,\n      \"customer_id\" : \"10\"\n    },\n    {\n      \"max_price\" : 233.0,\n      \"customer_id\" : \"11\"\n    },\n    {\n      \"max_price\" : 200.0,\n      \"customer_id\" : \"12\"\n    }\n    ...\n  ],\n  \"generated_dest_index\" : {\n    \"mappings\" : {\n      \"_meta\" : {\n        \"_transform\" : {\n          \"transform\" : \"transform-preview\",\n          \"version\" : {\n            \"created\" : \"7.7.0\"\n          },\n          \"creation_date_in_millis\" : 1584738236757\n        },\n        \"created_by\" : \"transform\"\n      },\n      \"properties\" : {\n        \"max_price\" : {\n          \"type\" : \"half_float\"\n        },\n        \"customer_id\" : {\n          \"type\" : \"keyword\"\n        }\n      }\n    },\n    \"settings\" : {\n      \"index\" : {\n        \"number_of_shards\" : \"1\",\n        \"auto_expand_replicas\" : \"0-1\"\n      }\n    },\n    \"aliases\" : { }\n  }\n}\n----\n// NOTCONSOLE\n"
}