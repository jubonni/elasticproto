{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.166286",
        "size": 6450,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/search-shards.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "search-shards",
        "version": "8.15"
    },
    "doc": "[[search-shards]]\n=== Search shards API\n++++\n<titleabbrev>Search shards</titleabbrev>\n++++\n\nReturns the indices and shards that a search request would be executed against.\n\n[source,console]\n--------------------------------------------------\nGET /my-index-000001/_search_shards\n--------------------------------------------------\n// TEST[s/^/PUT my-index-000001\\n{\"settings\":{\"index.number_of_shards\":5}}\\n/]\n\n\n[[search-shards-api-request]]\n==== {api-request-title}\n\n`GET /<target>/_search_shards`\n\n[[search-shards-api-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the\n`view_index_metadata` or `manage` <<privileges-list-indices,index privilege>>\nfor the target data stream, index, or alias.\n\n[[search-shards-api-desc]]\n==== {api-description-title}\n\nThe search shards api returns the indices and shards that a search request would\nbe executed against. This can give useful feedback for working out issues or\nplanning optimizations with routing and shard preferences. When filtered aliases\nare used, the filter is returned as part of the `indices` section.\n\n\n[[search-shards-api-path-params]]\n==== {api-path-parms-title}\n\n`<target>`::\n(Optional, string) Comma-separated list of data streams, indices, and aliases to\nsearch. Supports wildcards (`*`). To search all data streams and indices, omit\nthis parameter or use `*` or `_all`.\n\n[[search-shards-api-query-params]]\n==== {api-query-parms-title}\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=allow-no-indices]\n+\nDefaults to `true`.\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=expand-wildcards]\n+\n--\nDefaults to `open`.\n--\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=index-ignore-unavailable]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=local]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=preference]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=routing]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n\n[[search-shards-api-example]]\n==== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nGET /my-index-000001/_search_shards\n--------------------------------------------------\n// TEST[s/^/PUT my-index-000001\\n{\"settings\":{\"index.number_of_shards\":5}}\\n/]\n\nThe API returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"nodes\": ...,\n  \"indices\" : {\n    \"my-index-000001\": { }\n  },\n  \"shards\": [\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 0,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"0TvkCyF7TAmM1wHP4a42-A\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ],\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 1,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"fMju3hd1QHWmWrIgFnI4Ww\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ],\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 2,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"Nwl0wbMBTHCWjEEbGYGapg\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ],\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 3,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"bU_KLGJISbW0RejwnwDPKw\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ],\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 4,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"DMs7_giNSwmdqVukF7UydA\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ]\n  ]\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"nodes\": ...,/\"nodes\": $body.nodes,/]\n// TESTRESPONSE[s/JklnKbD7Tyqi9TP3_Q_tBg/$body.shards.0.0.node/]\n// TESTRESPONSE[s/0TvkCyF7TAmM1wHP4a42-A/$body.shards.0.0.allocation_id.id/]\n// TESTRESPONSE[s/fMju3hd1QHWmWrIgFnI4Ww/$body.shards.1.0.allocation_id.id/]\n// TESTRESPONSE[s/Nwl0wbMBTHCWjEEbGYGapg/$body.shards.2.0.allocation_id.id/]\n// TESTRESPONSE[s/bU_KLGJISbW0RejwnwDPKw/$body.shards.3.0.allocation_id.id/]\n// TESTRESPONSE[s/DMs7_giNSwmdqVukF7UydA/$body.shards.4.0.allocation_id.id/]\n\nSpecifying the same request, this time with a routing value:\n\n[source,console]\n--------------------------------------------------\nGET /my-index-000001/_search_shards?routing=foo,bar\n--------------------------------------------------\n// TEST[s/^/PUT my-index-000001\\n{\"settings\":{\"index.number_of_shards\":5}}\\n/]\n\nThe API returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"nodes\": ...,\n  \"indices\" : {\n      \"my-index-000001\": { }\n  },\n  \"shards\": [\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 2,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"fMju3hd1QHWmWrIgFnI4Ww\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ],\n    [\n      {\n        \"index\": \"my-index-000001\",\n        \"node\": \"JklnKbD7Tyqi9TP3_Q_tBg\",\n        \"relocating_node\": null,\n        \"primary\": true,\n        \"shard\": 3,\n        \"state\": \"STARTED\",\n        \"allocation_id\": {\"id\":\"0TvkCyF7TAmM1wHP4a42-A\"},\n        \"relocation_failure_info\" : {\n          \"failed_attempts\" : 0\n        }\n      }\n    ]\n  ]\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"nodes\": ...,/\"nodes\": $body.nodes,/]\n// TESTRESPONSE[s/JklnKbD7Tyqi9TP3_Q_tBg/$body.shards.1.0.node/]\n// TESTRESPONSE[s/0TvkCyF7TAmM1wHP4a42-A/$body.shards.1.0.allocation_id.id/]\n// TESTRESPONSE[s/fMju3hd1QHWmWrIgFnI4Ww/$body.shards.0.0.allocation_id.id/]\n\nBecause of the specified routing values,\nthe search is only executed against two of the shards.\n"
}