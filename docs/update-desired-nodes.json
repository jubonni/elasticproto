{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.502274",
        "size": 4275,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/update-desired-nodes.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "update-desired-nodes",
        "version": "8.15"
    },
    "doc": "[[update-desired-nodes]]\n=== Create or update desired nodes API\n++++\n<titleabbrev>Create or update desired nodes</titleabbrev>\n++++\n\nNOTE: {cloud-only}\n\nCreates or updates the desired nodes.\n\n[[update-desired-nodes-request]]\n==== {api-request-title}\n\n[source,console]\n--------------------------------------------------\nPUT /_internal/desired_nodes/<history_id>/<version>\n{\n    \"nodes\" : [\n        {\n            \"settings\" : {\n                 \"node.name\" : \"instance-000187\",\n                 \"node.external_id\": \"instance-000187\",\n                 \"node.roles\" : [\"data_hot\", \"master\"],\n                 \"node.attr.data\" : \"hot\",\n                 \"node.attr.logical_availability_zone\" : \"zone-0\"\n            },\n            \"processors\" : 8.0,\n            \"memory\" : \"58gb\",\n            \"storage\" : \"2tb\"\n        }\n    ]\n}\n--------------------------------------------------\n// TEST[s/<history_id>/test/]\n// TEST[s/<version>/1/]\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nDELETE /_internal/desired_nodes\n--------------------------------------------------\n// TEST[continued]\n\n//////////////////////////\n\n[[update-desired-nodes-query-params]]\n==== {api-query-parms-title}\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n\n`dry_run`::\n    (Optional, Boolean) If `true`, then the request simulates the update and\n    returns a response with `dry_run` field set to `true`.\n\n[[update-desired-nodes-desc]]\n==== {api-description-title}\n\nThis API creates or update the desired nodes. External orchestrators can use\nthis API to let Elasticsearch know about the cluster topology, including future\nchanges such as adding or removing nodes. Using this information, the system is\nable to take better decisions.\n\nIt's possible to run the update in \"dry run\" mode by adding the\n`?dry_run` query parameter. This will validate the request result, but will not actually perform the update.\n\n[[update-desired-nodes-examples]]\n==== {api-examples-title}\n\nIn this example, a new version for the desired nodes with history `Ywkh3INLQcuPT49f6kcppA` is created.\nThis API only accepts monotonically increasing versions.\n\n[source,console]\n--------------------------------------------------\nPUT /_internal/desired_nodes/Ywkh3INLQcuPT49f6kcppA/100\n{\n    \"nodes\" : [\n        {\n            \"settings\" : {\n                 \"node.name\" : \"instance-000187\",\n                 \"node.external_id\": \"instance-000187\",\n                 \"node.roles\" : [\"data_hot\", \"master\"],\n                 \"node.attr.data\" : \"hot\",\n                 \"node.attr.logical_availability_zone\" : \"zone-0\"\n            },\n            \"processors\" : 8.0,\n            \"memory\" : \"58gb\",\n            \"storage\" : \"2tb\"\n        }\n    ]\n}\n--------------------------------------------------\n// TEST\n\nThe API returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"replaced_existing_history_id\": false,\n  \"dry_run\": false\n}\n--------------------------------------------------\n\nAdditionally, it is possible to specify a processors range.\nThis is helpful in environments where Elasticsearch nodes can\nbe deployed in hosts where the number of processors that the\nElasticsearch process can use is guaranteed to be at least the\nlower range and up to the upper range. This is a common scenario\nin Linux deployments where cgroups is used.\n[source,console]\n--------------------------------------------------\nPUT /_internal/desired_nodes/Ywkh3INLQcuPT49f6kcppA/101\n{\n    \"nodes\" : [\n        {\n            \"settings\" : {\n                 \"node.name\" : \"instance-000187\",\n                 \"node.external_id\": \"instance-000187\",\n                 \"node.roles\" : [\"data_hot\", \"master\"],\n                 \"node.attr.data\" : \"hot\",\n                 \"node.attr.logical_availability_zone\" : \"zone-0\"\n            },\n            \"processors_range\" : {\"min\": 8.0, \"max\": 10.0},\n            \"memory\" : \"58gb\",\n            \"storage\" : \"2tb\"\n        }\n    ]\n}\n--------------------------------------------------\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nDELETE /_internal/desired_nodes\n--------------------------------------------------\n// TEST[continued]\n\n//////////////////////////\n"
}