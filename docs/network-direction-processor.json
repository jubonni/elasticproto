{
    "meta": {
        "size": 3889,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/network-direction-processor.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": false,
        "title": "network-direction-processor",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[network-direction-processor]]\n=== Network direction processor\n++++\n<titleabbrev>Network direction</titleabbrev>\n++++\n\nCalculates the network direction given a source IP address, destination IP\naddress, and a list of internal networks.\n\nThe network direction processor reads IP addresses from\n{ecs-ref}[Elastic Common Schema (ECS)] fields by default. If you use the ECS,\nonly the `internal_networks` option must be specified.\n\n[[network-direction-options]]\n.Network Direction Options\n[options=\"header\"]\n|======\n| Name               | Required | Default       | Description\n| `source_ip`        | no       | `source.ip`   | Field containing the source IP address.\n| `destination_ip`   | no       | `destination.ip` | Field containing the destination IP address.\n| `target_field`     | no       | `network.direction` | Output field for the network direction.\n| `internal_networks`| yes *    |               | List of internal networks. Supports IPv4 and\nIPv6 addresses and ranges in CIDR notation. Also supports the named ranges listed below. These may be constructed with <<template-snippets,template snippets>>. * Must specify only one of `internal_networks` or `internal_networks_field`.\n| `internal_networks_field`| no      |               | A field on the given document to read the `internal_networks` configuration from.\n| `ignore_missing`   | no       | `true`        | If `true` and any required fields are missing,\nthe processor quietly exits without modifying the document.\n\n\ninclude::common-options.asciidoc[]\n|======\n\nOne of either `internal_networks` or `internal_networks_field` must be specified. If `internal_networks_field` is specified, it follows the behavior specified by `ignore_missing`.\n\n[float]\n[[supported-named-network-ranges]]\n===== Supported named network ranges\n\nThe named ranges supported for the `internal_networks` option are:\n\n- `loopback` - Matches loopback addresses in the range of `127.0.0.0/8` or\n  `::1/128`.\n- `unicast` or `global_unicast` - Matches global unicast addresses defined in\n   RFC 1122, RFC 4632, and RFC 4291 with the exception of the IPv4 broadcast\n   address (`255.255.255.255`). This includes private address ranges.\n- `multicast` - Matches multicast addresses.\n- `interface_local_multicast` - Matches IPv6 interface-local multicast addresses.\n- `link_local_unicast` - Matches link-local unicast addresses.\n- `link_local_multicast` - Matches link-local multicast addresses.\n- `private` - Matches private address ranges defined in RFC 1918 (IPv4) and\n  RFC 4193 (IPv6).\n- `public` - Matches addresses that are not loopback, unspecified, IPv4\n  broadcast, link local unicast, link local multicast, interface local\n  multicast, or private.\n- `unspecified` - Matches unspecified addresses (either the IPv4 address\n  \"0.0.0.0\" or the IPv6 address \"::\").\n\n\n[discrete]\n[[network-direction-processor-ex]]\n===== Examples\n\nThe following example illustrates the use of the network direction processor:\n\n[source,console]\n----\nPOST _ingest/pipeline/_simulate\n{\n  \"pipeline\": {\n    \"processors\": [\n      {\n        \"network_direction\": {\n          \"internal_networks\": [\"private\"]\n        }\n      }\n    ]\n  },\n  \"docs\": [\n    {\n      \"_source\": {\n        \"source\": {\n          \"ip\": \"128.232.110.120\"\n        },\n        \"destination\": {\n          \"ip\": \"192.168.1.1\"\n        }\n      }\n    }\n  ]\n}\n----\n\nWhich produces the following result:\n\n[source,console-result]\n----\n{\n  \"docs\": [\n    {\n      \"doc\": {\n        ...\n        \"_source\": {\n          \"destination\": {\n            \"ip\": \"192.168.1.1\"\n          },\n          \"source\": {\n            \"ip\": \"128.232.110.120\"\n          },\n          \"network\": {\n            \"direction\": \"inbound\"\n          }\n        }\n      }\n    }\n  ]\n}\n----\n// TESTRESPONSE[s/\\.\\.\\./\"_index\":\"_index\",\"_id\":\"_id\",\"_version\":\"-3\",\"_ingest\":{\"timestamp\":$body.docs.0.doc._ingest.timestamp},/]\n// NOTCONSOLE\n"
}