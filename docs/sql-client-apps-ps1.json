{
    "meta": {
        "size": 1664,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/sql-client-apps-ps1.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": false,
        "title": "sql-client-apps-ps1",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[sql-client-apps-ps1]]\n=== Microsoft PowerShell\n\nYou can use the {es} ODBC driver to access {es} data from Microsoft PowerShell.\n\nIMPORTANT: Elastic does not endorse, promote or provide support for this application; for native Elasticsearch integration in this product, please reach out to its vendor.\n\n==== Prerequisites\n\n* https://docs.microsoft.com/en-us/powershell/[Microsoft PowerShell]\n* {es-sql} <<sql-odbc, ODBC driver>>\n* A preconfigured User or System DSN (see <<dsn-configuration,Configuration>> section on how to configure a DSN).\n\n==== Writing a script\n\nWhile putting the following instructions into a script file is not an absolute requirement, doing so will make it easier to extend and\nreuse. The following instructions exemplify how to execute a simple SELECT query from an existing index in your {es} instance, using a DSN\nconfigured in advance. Open a new file, `select.ps1`, and place the following instructions in it:\n\n[\"source\",\"powershell\",subs=\"attributes,callouts\"]\n--------------------------------------------\n$connectstring = \"DSN=Local Elasticsearch;\"\n$sql = \"SELECT * FROM library\"\n\n$conn = New-Object System.Data.Odbc.OdbcConnection($connectstring)\n$conn.open()\n$cmd = New-Object system.Data.Odbc.OdbcCommand($sql,$conn)\n$da = New-Object system.Data.Odbc.OdbcDataAdapter($cmd)\n$dt = New-Object system.Data.datatable\n$null = $da.fill($dt)\n$conn.close()\n$dt\n--------------------------------------------\n\nNow open a PowerShell shell and simply execute the script:\n\n[[apps_excel_exed]]\n.Run SQL in PowerShell\nimage:images/sql/odbc/apps_ps_exed.png[]\n\n\n// vim: set noet fenc=utf-8 ff=dos sts=0 sw=4 ts=4 tw=138 columns=140\n"
}