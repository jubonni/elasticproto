{
    "meta": {
        "timestamp": "2024-11-01T03:02:52.338581",
        "size": 5760,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/date-index-name-processor.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "date-index-name-processor",
        "version": "8.15"
    },
    "doc": "[[date-index-name-processor]]\n=== Date index name processor\n++++\n<titleabbrev>Date index name</titleabbrev>\n++++\n\nThe purpose of this processor is to point documents to the right time based index based\non a date or timestamp field in a document by using the <<api-date-math-index-names, date math index name support>>.\n\nThe processor sets the `_index` metadata field with a date math index name expression based on the provided index name\nprefix, a date or timestamp field in the documents being processed and the provided date rounding.\n\nFirst, this processor fetches the date or timestamp from a field in the document being processed. Optionally,\ndate formatting can be configured on how the field's value should be parsed into a date. Then this date,\nthe provided index name prefix and the provided date rounding get formatted into a date math index name expression.\nAlso here optionally date formatting can be specified on how the date should be formatted into a date math index name\nexpression.\n\nAn example pipeline that points documents to a monthly index that starts with a `my-index-` prefix based on a\ndate in the `date1` field:\n\n[source,console]\n--------------------------------------------------\nPUT _ingest/pipeline/monthlyindex\n{\n  \"description\": \"monthly date-time index naming\",\n  \"processors\" : [\n    {\n      \"date_index_name\" : {\n        \"field\" : \"date1\",\n        \"index_name_prefix\" : \"my-index-\",\n        \"date_rounding\" : \"M\"\n      }\n    }\n  ]\n}\n--------------------------------------------------\n\n\nUsing that pipeline for an index request:\n\n[source,console]\n--------------------------------------------------\nPUT /my-index/_doc/1?pipeline=monthlyindex\n{\n  \"date1\" : \"2016-04-25T12:02:01.789Z\"\n}\n--------------------------------------------------\n// TEST[continued]\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"_index\" : \"my-index-2016-04-01\",\n  \"_id\" : \"1\",\n  \"_version\" : 1,\n  \"result\" : \"created\",\n  \"_shards\" : {\n    \"total\" : 2,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"_seq_no\" : 55,\n  \"_primary_term\" : 1\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"_seq_no\" : \\d+/\"_seq_no\" : $body._seq_no/ s/\"_primary_term\" : 1/\"_primary_term\" : $body._primary_term/]\n\n\nThe above request will not index this document into the `my-index` index, but into the `my-index-2016-04-01` index because\nit was rounded by month. This is because the date-index-name-processor overrides the `_index` property of the document.\n\nTo see the date-math value of the index supplied in the actual index request which resulted in the above document being\nindexed into `my-index-2016-04-01` we can inspect the effects of the processor using a simulate request.\n\n\n[source,console]\n--------------------------------------------------\nPOST _ingest/pipeline/_simulate\n{\n  \"pipeline\" :\n  {\n    \"description\": \"monthly date-time index naming\",\n    \"processors\" : [\n      {\n        \"date_index_name\" : {\n          \"field\" : \"date1\",\n          \"index_name_prefix\" : \"my-index-\",\n          \"date_rounding\" : \"M\"\n        }\n      }\n    ]\n  },\n  \"docs\": [\n    {\n      \"_source\": {\n        \"date1\": \"2016-04-25T12:02:01.789Z\"\n      }\n    }\n  ]\n}\n--------------------------------------------------\n\nand the result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"docs\" : [\n    {\n      \"doc\" : {\n        \"_id\" : \"_id\",\n        \"_index\" : \"<my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}>\",\n        \"_version\" : \"-3\",\n        \"_source\" : {\n          \"date1\" : \"2016-04-25T12:02:01.789Z\"\n        },\n        \"_ingest\" : {\n          \"timestamp\" : \"2016-11-08T19:43:03.850+0000\"\n        }\n      }\n    }\n  ]\n}\n--------------------------------------------------\n// TESTRESPONSE[s/2016-11-08T19:43:03.850\\+0000/$body.docs.0.doc._ingest.timestamp/]\n\nThe above example shows that `_index` was set to `<my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}>`. Elasticsearch\nunderstands this to mean `2016-04-01` as is explained in the <<api-date-math-index-names, date math index name documentation>>\n\n[[date-index-name-options]]\n.Date index name options\n[options=\"header\"]\n|======\n| Name                   | Required  | Default                      | Description\n| `field`                | yes       | -                            | The field to get the date or timestamp from.\n| `index_name_prefix`    | no        | -                            | A prefix of the index name to be prepended before the printed date. Supports <<template-snippets,template snippets>>.\n| `date_rounding`        | yes       | -                            | How to round the date when formatting the date into the index name. Valid values are: `y` (year), `M` (month), `w` (week), `d` (day), `h` (hour), `m` (minute) and `s` (second). Supports <<template-snippets,template snippets>>.\n| `date_formats`         | no        | yyyy-MM-dd+++'T'+++HH:mm:ss.SSSXX  | An array of the expected date formats for parsing dates / timestamps in the document being preprocessed. Can be a java time pattern or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.\n| `timezone`             | no        | UTC                          | The timezone to use when parsing the date and when date math index supports resolves expressions into concrete index names.\n| `locale`               | no        | ENGLISH                      | The locale to use when parsing the date from the document being preprocessed, relevant when parsing month names or week days.\n| `index_name_format`    | no        | yyyy-MM-dd                   | The format to be used when printing the parsed date into the index name. A valid java time pattern is expected here. Supports <<template-snippets,template snippets>>.\ninclude::common-options.asciidoc[]\n|======\n"
}