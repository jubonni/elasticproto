{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.849580",
        "size": 2870,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-upgrade-job-model-snapshot.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "ml-upgrade-job-model-snapshot",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ml-upgrade-job-model-snapshot]]\n= Upgrade model snapshots API\n++++\n<titleabbrev>Upgrade model snapshots</titleabbrev>\n++++\n\nUpgrades an {anomaly-detect} model snapshot to the latest major version.\n\nNOTE: From {es} 8.10.0,  a new version number is used to\ntrack the configuration and state changes in the {ml} plugin. This new\nversion number is decoupled from the product version and will increment\nindependently.\n\n[[ml-upgrade-job-model-snapshot-request]]\n== {api-request-title}\n\n`POST _ml/anomaly_detectors/<job_id>/model_snapshots/<snapshot_id>/_upgrade`\n\n[[ml-upgrade-job-model-snapshot-prereqs]]\n== {api-prereq-title}\n\n* Requires the `manage_ml` cluster privilege. This privilege is included in the\n`machine_learning_admin` built-in role.\n* The upgraded snapshot must have a version matching the previous major version.\n* The upgraded snapshot must NOT be the current {anomaly-job} snapshot.\n\n[[ml-upgrade-job-model-snapshot-desc]]\n== {api-description-title}\n\nOver time, older snapshot formats are deprecated and removed. {anomaly-jobs-cap}\nsupport only snapshots that are from the current or previous major version.\n\nThis API provides a means to upgrade a snapshot to the current major version.\nThis aids in preparing the cluster for an upgrade to the next major version.\n\nOnly one snapshot per {anomaly-job} can be upgraded at a time and the upgraded\nsnapshot cannot be the current snapshot of the {anomaly-job}.\n\n[[ml-upgrade-job-model-snapshot-path-parms]]\n== {api-path-parms-title}\n\n`<job_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`<snapshot_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=snapshot-id]\n\n\n[[ml-upgrade-job-model-snapshot-query-parms]]\n== {api-query-parms-title}\n\n`timeout`::\n(Optional, time) Controls the time to wait for the request to complete. The\ndefault value is 30 minutes.\n\n`wait_for_completion`::\n(Optional, boolean) When true, the API won't respond until the upgrade is\ncomplete. Otherwise, it responds as soon as the upgrade task is assigned to a\nnode. Default is false.\n\n[[ml-upgrade-job-model-snapshot-response-body]]\n== {api-response-body-title}\n\n`node`::\n  (string) The ID of the assigned node for the upgrade task if it is still running.\n\n`completed`::\n  (boolean) When true, this means the task is complete. When false, it is still running.\n\n[[ml-upgrade-job-model-snapshot-example]]\n== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nPOST _ml/anomaly_detectors/low_request_rate/model_snapshots/1828371/_upgrade?timeout=45m&wait_for_completion=true\n--------------------------------------------------\n// TEST[skip:Kibana sample data]\n\nWhen the snapshot upgrade starts, you receive the following results:\n\n[source,console-result]\n----\n{\n  \"completed\" : false,\n  \"node\" : \"node-1\"\n}\n----\n"
}