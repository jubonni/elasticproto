{
    "meta": {
        "timestamp": "2024-11-01T02:49:25.316067",
        "size": 3602,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-has-privileges.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "security-api-has-privileges",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[security-api-has-privileges]]\n=== Has privileges API\n++++\n<titleabbrev>Has privileges</titleabbrev>\n++++\n[[security-api-has-privilege]]\n\nDetermines whether the logged in user has a specified list of privileges.\n\n[[security-api-has-privileges-request]]\n==== {api-request-title}\n\n`GET /_security/user/_has_privileges`\n\n`POST /_security/user/_has_privileges`\n\n\n[[security-api-has-privileges-prereqs]]\n==== {api-prereq-title}\n\n* All users can use this API, but only to determine their own privileges.\nTo check the privileges of other users, you must use the run as feature. For\nmore information, see\n<<run-as-privilege>>.\n\n[[security-api-has-privileges-desc]]\n==== {api-description-title}\n\nFor a list of the privileges that you can specify in this API,\nsee <<security-privileges>>.\n\nA successful call returns a JSON structure that shows whether each specified\nprivilege is assigned to the user.\n\n[[security-api-has-privileges-request-body]]\n==== {api-request-body-title}\n\n`cluster`:: (list) A list of the cluster privileges that you want to check.\n\n`index`::\n`names`::: (list) A list of indices.\n`allow_restricted_indices`::: (Boolean) This needs to be set to `true` (default\nis `false`) if using wildcards or regexps for patterns that cover restricted\nindices. Implicitly, restricted indices do not match index patterns because\nrestricted indices usually have limited privileges and including them in\npattern tests would render most such tests `false`. If restricted indices are\nexplicitly included in the `names` list, privileges will be checked against\nthem regardless of the value of `allow_restricted_indices`.\n`privileges`::: (list) A list of the privileges that you want to check for the\nspecified indices.\n\n`application`::\n`application`::: (string) The name of the application.\n`privileges`::: (list) A list of the privileges that you want to check for the\nspecified resources. May be either application privilege names, or the names of\nactions that are granted by those privileges\n`resources`::: (list) A list of resource names against which the privileges\nshould be checked\n\n\n[[security-api-has-privileges-example]]\n==== {api-examples-title}\n\nThe following example checks whether the current user has a specific set of\ncluster, index, and application privileges:\n\n[source,console]\n--------------------------------------------------\nGET /_security/user/_has_privileges\n{\n  \"cluster\": [ \"monitor\", \"manage\" ],\n  \"index\" : [\n    {\n      \"names\": [ \"suppliers\", \"products\" ],\n      \"privileges\": [ \"read\" ]\n    },\n    {\n      \"names\": [ \"inventory\" ],\n      \"privileges\" : [ \"read\", \"write\" ]\n    }\n  ],\n  \"application\": [\n    {\n      \"application\": \"inventory_manager\",\n      \"privileges\" : [ \"read\", \"data:write/inventory\" ],\n      \"resources\" : [ \"product/1852563\" ]\n    }\n  ]\n}\n--------------------------------------------------\n\nThe following example output indicates which privileges the \"rdeniro\" user has:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"username\": \"rdeniro\",\n  \"has_all_requested\" : false,\n  \"cluster\" : {\n    \"monitor\" : true,\n    \"manage\" : false\n  },\n  \"index\" : {\n    \"suppliers\" : {\n      \"read\" : true\n    },\n    \"products\" : {\n      \"read\" : true\n    },\n    \"inventory\" : {\n      \"read\" : true,\n      \"write\" : false\n    }\n  },\n  \"application\" : {\n    \"inventory_manager\" : {\n      \"product/1852563\" : {\n        \"read\": false,\n        \"data:write/inventory\": false\n      }\n    }\n  }\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"rdeniro\"/\"$body.username\"/]\n// TESTRESPONSE[s/: false/: true/]\n"
}