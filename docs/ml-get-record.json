{
    "meta": {
        "size": 9925,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-get-record.html",
        "type": "documentation",
        "role": [
            "xpack",
            "child_attributes",
            "child_attributes"
        ],
        "has_code": true,
        "title": "ml-get-record",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ml-get-record]]\n= Get records API\n++++\n<titleabbrev>Get records</titleabbrev>\n++++\n\nRetrieves anomaly records for an {anomaly-job}.\n\n[[ml-get-record-request]]\n== {api-request-title}\n\n`GET _ml/anomaly_detectors/<job_id>/results/records`\n\n[[ml-get-record-prereqs]]\n== {api-prereq-title}\n\nRequires the `monitor_ml` cluster privilege. This privilege is included in the\n`machine_learning_user` built-in role.\n\n[[ml-get-record-desc]]\n== {api-description-title}\n\nRecords contain the detailed analytical results. They describe the anomalous\nactivity that has been identified in the input data based on the detector\nconfiguration.\n\nThere can be many anomaly records depending on the characteristics and size of\nthe input data. In practice, there are often too many to be able to manually\nprocess them. The {ml-features} therefore perform a sophisticated aggregation of\nthe anomaly records into buckets.\n\nThe number of record results depends on the number of anomalies found in each\nbucket, which relates to the number of time series being modeled and the number\nof detectors.\n\n[[ml-get-record-path-parms]]\n== {api-path-parms-title}\n\n`<job_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n[[ml-get-record-query-parms]]\n== {api-query-parms-title}\n\n`desc`::\n(Optional, Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=desc-results]\n\n`end`::\n(Optional, string) Returns records with timestamps earlier than this time.\nDefaults to `-1`, which means it is unset and results are not limited to\nspecific timestamps.\n\n`exclude_interim`::\n(Optional, Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=exclude-interim-results]\n\n`from`::\n(Optional, integer) Skips the specified number of records. Defaults to `0`.\n\n`record_score`::\n(Optional, double) Returns records with anomaly scores greater or equal than\nthis value. Defaults to `0.0`.\n\n`size`::\n(Optional, integer) Specifies the maximum number of records to obtain. Defaults\nto `100`.\n\n`sort`::\n(Optional, string) Specifies the sort field for the requested records. By\ndefault, the records are sorted by the `record_score` value.\n\n`start`::\n(Optional, string) Returns records with timestamps after this time. Defaults to\n`-1`, which means it is unset and results are not limited to specific timestamps.\n\n[role=\"child_attributes\"]\n[[ml-get-record-request-body]]\n== {api-request-body-title}\n\nYou can also specify the query parameters in the request body; the exception are\n`from` and `size`, use `page` instead:\n\n`page`::\n+\n.Properties of `page`\n[%collapsible%open]\n====\n\n`from`:::\n(Optional, integer) Skips the specified number of records. Defaults to `0`.\n\n`size`:::\n(Optional, integer) Specifies the maximum number of records to obtain. Defaults\nto `100`.\n====\n\n[role=\"child_attributes\"]\n[[ml-get-record-results]]\n== {api-response-body-title}\n\nThe API returns an array of record objects, which have the following properties:\n\n`actual`::\n(array) The actual value for the bucket.\n\n//Begin anomaly_score_explanation\n`anomaly_score_explanation`::\n(object) When present, it provides information about the factors impacting the\ninitial anomaly score.\n+\n.Properties of `anomaly_score_explanation`\n[%collapsible%open]\n====\n`anomaly_characteristics_impact`::::\n(Optional, integer) Impact from the duration and magnitude of the detected anomaly \nrelative to the historical average.\n\n`anomaly_length`::::\n(Optional, integer) Length of the detected anomaly in the number of buckets.\n\n`anomaly_type`::::\n(Optional, string) Type of the detected anomaly: spike or dip.\n\n`high_variance_penalty`::::\n(Optional, boolean) Indicates reduction of anomaly score for the bucket with large \nconfidence intervals. If a bucket has large confidence intervals, the score is reduced.\n\n`incomplete_bucket_penalty`::::\n(Optional, boolean) If the bucket contains fewer samples than expected, the score is \nreduced. If the bucket contains fewer samples than expected, the score is reduced.\n\n`lower_confidence_bound`::::\n(Optional, double) Lower bound of the 95% confidence interval.\n\n`multimodal_distribution`::::\n(Optional, boolean) Indicates whether the bucket values' probability distribution has \nseveral modes. When there are multiple modes, the typical value may not be the most \nlikely.\n\n`multi_bucket_impact`::::\n(Optional, integer) Impact of the deviation between actual and typical values in the \npast 12 buckets.\n\n`single_bucket_impact`::::\n(Optional, integer) Impact of the deviation between actual and typical values in the \ncurrent bucket.\n\n`typical_value`::::\n(Optional, double) Typical (expected) value for this bucket.\n\n`upper_confidence_bound`::::\n(Optional, double) Upper bound of the 95% confidence interval.\n====\n//End anomaly_score_explanation\n\n`bucket_span`::\n(number)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=bucket-span-results]\n\n`by_field_name`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=by-field-name]\n\n`by_field_value`::\n(string) The value of `by_field_name`.\n\n`causes`::\n(array) For population analysis, an over field must be specified in the detector.\nThis property contains an array of anomaly records that are the causes for the\nanomaly that has been identified for the over field. If no over fields exist,\nthis field is not present. This sub-resource contains the most anomalous records\nfor the `over_field_name`. For scalability reasons, a maximum of the 10 most\nsignificant causes of the anomaly are returned. As part of the core analytical \nmodeling, these low-level anomaly records are aggregated for their parent over\nfield record. The causes resource contains similar elements to the record\nresource, namely `actual`, `typical`, `geo_results.actual_point`,\n`geo_results.typical_point`, `*_field_name` and `*_field_value`. Probability and\nscores are not applicable to causes.\n\n`detector_index`::\n(number) A unique identifier for the detector.\n\n`field_name`::\n(string) Certain functions require a field to operate on, for example, `sum()`.\nFor those functions, this value is the name of the field to be analyzed.\n\n`function`::\n(string) The function in which the anomaly occurs, as specified in the detector\nconfiguration. For example, `max`.\n\n`function_description`::\n(string) The description of the function in which the anomaly occurs, as\nspecified in the detector configuration.\n\n`geo_results`::\n(optional, object) If the detector function is `lat_long`, this object contains\ncomma delimited strings for the latitude and longitude of the actual and typical values.  \n+\n.Properties of `geo_results`\n[%collapsible%open]\n====\n`actual_point`::\n(string) The actual value for the bucket formatted as a `geo_point`.\n\n`typical_point`::\n(string) The typical value for the bucket formatted as a `geo_point`.\n====\n\n`influencers`::\n(array) If `influencers` was specified in the detector configuration, this array\ncontains influencers that contributed to or were to blame for an anomaly.\n\n`initial_record_score`::\n(number) A normalized score between 0-100, which is based on the probability of\nthe anomalousness of this record. This is the initial value that was calculated\nat the time the bucket was processed.\n\n`is_interim`::\n(Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=is-interim]\n\n`job_id`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`multi_bucket_impact`::\n(number) An indication of how strongly an anomaly is multi bucket or single\nbucket. The value is on a scale of `-5.0` to `+5.0` where `-5.0` means the\nanomaly is purely single bucket and `+5.0` means the anomaly is purely multi\nbucket.\n\n`over_field_name`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=over-field-name]\n\n`over_field_value`::\n(string) The value of `over_field_name`.\n\n`partition_field_name`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=partition-field-name]\n\n`partition_field_value`::\n(string) The value of `partition_field_name`.\n\n`probability`::\n(number) The probability of the individual anomaly occurring, in the range\n0 to 1. For example, 0.0000772031. This value can be held to a high precision\nof over 300 decimal places, so the `record_score` is provided as a\nhuman-readable and friendly interpretation of this.\n\n`record_score`::\n(number) A normalized score between 0-100, which is based on the probability of\nthe anomalousness of this record. Unlike `initial_record_score`, this value will\nbe updated by a re-normalization process as new data is analyzed.\n\n`result_type`::\n(string) Internal. This is always set to `record`.\n\n`timestamp`::\n(date)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=timestamp-results]\n\n`typical`::\n(array) The typical value for the bucket, according to analytical modeling.\n\nNOTE: Additional record properties are added, depending on the fields being\nanalyzed. For example, if it's analyzing `hostname` as a _by field_, then a field\n`hostname` is added to the result document. This information enables you to\nfilter the anomaly results more easily.\n\n\n[[ml-get-record-example]]\n== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nGET _ml/anomaly_detectors/low_request_rate/results/records\n{\n  \"sort\": \"record_score\",\n  \"desc\": true,\n  \"start\": \"1454944100000\"\n}\n--------------------------------------------------\n// TEST[skip:Kibana sample data]\n\n[source,js]\n----\n{\n  \"count\" : 4,\n  \"records\" : [\n    {\n      \"job_id\" : \"low_request_rate\",\n      \"result_type\" : \"record\",\n      \"probability\" : 1.3882308899968812E-4,\n      \"multi_bucket_impact\" : -5.0,\n      \"record_score\" : 94.98554565630553,\n      \"initial_record_score\" : 94.98554565630553,\n      \"bucket_span\" : 3600,\n      \"detector_index\" : 0,\n      \"is_interim\" : false,\n      \"timestamp\" : 1577793600000,\n      \"function\" : \"low_count\",\n      \"function_description\" : \"count\",\n      \"typical\" : [\n        28.254208230188834\n      ],\n      \"actual\" : [\n        0.0\n      ]\n    },\n  ...\n  ]\n}\n----\n"
}