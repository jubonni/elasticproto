{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.989598",
        "size": 20104,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/release-notes-8.7.0.html",
        "type": "documentation",
        "role": [],
        "has_code": false,
        "title": "release-notes-8.7.0",
        "version": "8.15"
    },
    "doc": "[[release-notes-8.7.0]]\n== {es} version 8.7.0\n\nAlso see <<breaking-changes-8.7,Breaking changes in 8.7>>.\n\n[[known-issues-8.7.0]]\n[float]\n=== Known issues\n\ninclude::8.6.0.asciidoc[tag=reconciliation-imbalance-known-issue]\n\n[[breaking-8.7.0]]\n[float]\n=== Breaking changes\n\nIngest Node::\n* Making `JsonProcessor` stricter so that it does not silently drop data {es-pull}93179[#93179] (issue: {es-issue}92898[#92898])\n\nIndices APIs::\n* The <<indices-resolve-index-api>> API implementation was adjusted to use the\nsame index resolution mechanism as other similar APIs, adding support for the\n`ignore_unavailable` and `allow_no_indices` flags and the `_all` meta-index. If\nthere are no matching indices then earlier versions of this API would return an\nempty result with the `200 OK` HTTP response code, but from 8.7.0 onwards by\ndefault it returns an `IndexNotFoundException` with the `404 Not Found` HTTP\nresponse code. To recover the old behaviour, add the query parameter\n`?ignore_unavailable=true` ({es-pull}92820[#92820]).\n\n[[bug-8.7.0]]\n[float]\n=== Bug fixes\n\nAggregations::\n* Don't create a new `DoubleHistogram` instance for empty buckets {es-pull}92547[#92547]\n* Fix: do not allow map key types other than String {es-pull}88686[#88686] (issue: {es-issue}66057[#66057])\n\nAllocation::\n* Fallback to the actual shard size when forecast is not available {es-pull}93461[#93461]\n* Skip `DiskThresholdMonitor` when cluster state is not recovered {es-pull}93699[#93699]\n* Suppress response headers in `AllocationActionMultiListener` {es-pull}93777[#93777] (issue: {es-issue}93773[#93773])\n\nAuthentication::\n* Correctly remove domain from realm when rewriting `Authentication` for compatibility with node versions that don't\nsupport domains {es-pull}93276[#93276]\n\nAuthorization::\n* Fix Security's expression resolver to not remove unavailable but authorized names {es-pull}92625[#92625]\n\nCCR::\n* Deduplicate Heavy CCR Repository CS Requests {es-pull}91398[#91398]\n\nCRUD::\n* Avoid NPE in Stateless Get/mGet {es-pull}94164[#94164]\n* Do not refresh all indices in `TransportBulkAction` {es-pull}93417[#93417]\n\nCluster Coordination::\n* Delay master task failure notifications until commit {es-pull}92693[#92693] (issue: {es-issue}92677[#92677])\n\nData streams::\n* Allow different filters per `DataStream` in a `DataStreamAlias` {es-pull}92692[#92692] (issue: {es-issue}92050[#92050])\n\nGeo::\n* Build index qualified name in cross cluster vector tile search {es-pull}94574[#94574] (issue: {es-issue}94557[#94557])\n* Check `GeohexGrid` bounds on geopoint using spherical coordinates {es-pull}92460[#92460]\n* Fix bug when clipping Geometry collections in vector tiles {es-pull}93562[#93562]\n\nHealth::\n* Take into account `max_headroom` in disk watermark calculations {es-pull}93157[#93157] (issue: {es-issue}93155[#93155])\n\nILM+SLM::\n* Allow ILM step transition to the phase terminal step {es-pull}91754[#91754]\n* Avoiding `BulkProcessor` deadlock in ILMHistoryStore {es-pull}91238[#91238] (issues: {es-issue}68468[#68468], {es-issue}50440[#50440])\n* Fixed changing only the `forceMerge` flag in `SearchableSnapshotAction` wouldn't update the policy {es-pull}93847[#93847]\n* Preventing ILM and SLM runtime state from being stored in a snapshot {es-pull}92252[#92252]\n\nInfra/CLI::\n* Restore printing bootstrap checks as errors {es-pull}93178[#93178] (issue: {es-issue}93074[#93074])\n\nInfra/Core::\n* Add `jdk.internal.reflect` permission to es codebase {es-pull}92387[#92387] (issue: {es-issue}92356[#92356])\n* Add checks for exception loops through suppressed exceptions only {es-pull}93944[#93944] (issue: {es-issue}93943[#93943])\n* Ensure one-shot wrappers release their delegates {es-pull}92928[#92928]\n* Fix `InputStream#readAllBytes` on `InputStreamIndexInput` {es-pull}92680[#92680]\n* Fix indices resolver for datemath with colon {es-pull}92973[#92973]\n* Make `FilterStreamInput` less trappy {es-pull}92422[#92422]\n\nInfra/Plugins::\n* Ensure ordering of plugin initialization {es-pull}93882[#93882] (issue: {es-issue}93851[#93851])\n* Fix unclosed directory stream in `ClassReaders` {es-pull}92890[#92890] (issue: {es-issue}92866[#92866])\n* Update the version of asm used by plugin scanner {es-pull}92784[#92784] (issue: {es-issue}92782[#92782])\n\nInfra/REST API::\n* [Rest Api Compatibility] Format response media type with parameters {es-pull}92695[#92695]\n\nInfra/Scripting::\n* Fix NPE when method was called on an array type {es-pull}91713[#91713] (issue: {es-issue}87562[#87562])\n\nInfra/Settings::\n* Fix parse failures for ILM operator settings {es-pull}94477[#94477] (issue: {es-issue}94465[#94465])\n\nIngest Node::\n* Better names and types for ingest stats {es-pull}93533[#93533] (issue: {es-issue}80763[#80763])\n* Correctly handle an exception case for ingest failure {es-pull}92455[#92455]\n* Disable ingest-attachment logging {es-pull}93878[#93878]\n* Download the geoip databases only when needed {es-pull}92335[#92335] (issue: {es-issue}90673[#90673])\n* Forwarding simulate calls to ingest nodes {es-pull}92171[#92171]\n* Grok returns a list of matches for repeated pattern names #92092 {es-pull}92586[#92586] (issue: {es-issue}92092[#92092])\n* Handle a default/request pipeline and a final pipeline with minimal additional overhead {es-pull}93329[#93329] (issues: {es-issue}92843[#92843], {es-issue}81244[#81244], {es-issue}93118[#93118])\n* Ingest-attachment module tika dependency versions {es-pull}93755[#93755]\n* More accurate total ingest stats {es-pull}91730[#91730] (issue: {es-issue}91358[#91358])\n* Speed up ingest geoip processors {es-pull}92372[#92372]\n* Speed up ingest set and append processors {es-pull}92395[#92395]\n\nMachine Learning::\n* Allocate trained models if zone awareness attributes not set {es-pull}94128[#94128] (issue: {es-issue}94123[#94123])\n* Fix data counts race condition when starting a datafeed {es-pull}93324[#93324] (issue: {es-issue}93298[#93298])\n* Fix tokenization bug when handling normalization in BERT and MPNet {es-pull}92329[#92329]\n* Free resources correctly when model loading is cancelled {es-pull}92204[#92204]\n* Stop the `frequent_items` aggregation reporting a subset when a superset exists {es-pull}92239[#92239]\n* Use long inference timeout at ingest {es-pull}93731[#93731]\n\nMapping::\n* Fix dynamic mapping detection for invalid dates {es-pull}94115[#94115] (issue: {es-issue}93888[#93888])\n* No length check for source-only keyword fields {es-pull}93299[#93299] (issue: {es-issue}9304[#9304])\n\nNetwork::\n* Delay Connection#onRemoved while pending {es-pull}92546[#92546]\n* Fix fransport handshake starting before tls handshake completes {es-pull}90534[#90534] (issue: {es-issue}77999[#77999])\n* Protect `NodeConnectionsService` from stale conns {es-pull}92558[#92558] (issue: {es-issue}92029[#92029])\n\nRecovery::\n* Disable recovery monitor before recovery start {es-pull}93551[#93551] (issue: {es-issue}93542[#93542])\n* Fix potential leak in `RemoteRecoveryHandler` {es-pull}91802[#91802]\n* Report recovered files as recovered from snapshot for fully mounted searchable snapshots {es-pull}92976[#92976]\n\nRollup::\n* Downsampling unmapped text fields {es-pull}94387[#94387] (issue: {es-issue}94346[#94346])\n* Propagate timestamp format and convert nanoseconds to milliseconds {es-pull}94141[#94141] (issue: {es-issue}94085[#94085])\n* Stop processing `TransportDownsampleAction` on failure {es-pull}94624[#94624]\n* Support downsampling of histogram as labels {es-pull}93445[#93445] (issue: {es-issue}93263[#93263])\n\nSearch::\n* Add null check for sort fields over collapse fields {es-pull}94546[#94546] (issue: {es-issue}94407[#94407])\n* Annotated highlighter does not match when search contains both annotation and annotated term {es-pull}92920[#92920] (issue: {es-issue}91944[#91944])\n* Clear field caps index responses on cancelled {es-pull}93716[#93716] (issue: {es-issue}93029[#93029])\n* Do not include frozen indices in PIT by default {es-pull}94377[#94377]\n* Fix NPE thrown by prefix query in strange scenarios {es-pull}94369[#94369]\n* Fix _id field fetch issue. {es-pull}94528[#94528] (issue: {es-issue}94515[#94515])\n* Fix metadata `_size` when it comes to stored fields extraction {es-pull}94483[#94483] (issue: {es-issue}94468[#94468])\n* Fix missing override for matches in `ProfileWeight` {es-pull}92360[#92360]\n* Nested path info shouldn't be added during `copy_to` {es-pull}93340[#93340] (issue: {es-issue}93117[#93117])\n* Use all profiling events on startup {es-pull}92087[#92087]\n* Use keyword analyzer for untokenized fields in `TermVectorsService` {es-pull}94518[#94518]\n* [Profiling] Adjust handling of last data slice {es-pull}94283[#94283]\n* [Profiling] Ensure responses are only sent once {es-pull}93692[#93692] (issue: {es-issue}93691[#93691])\n* [Profiling] Handle response processing errors {es-pull}93860[#93860]\n\nSnapshot/Restore::\n* Fix unhandled exception when blobstore repository contains unexpected file {es-pull}93914[#93914]\n* Support for GCS proxies everywhere in the GCS API {es-pull}92192[#92192] (issue: {es-issue}91952[#91952])\n\nStats::\n* Avoid capturing cluster state in TBbNA {es-pull}92255[#92255]\n\nTSDB::\n* Fix synthetic `_source` for sparse `_doc_count` field {es-pull}91769[#91769] (issue: {es-issue}91731[#91731])\n\nTask Management::\n* Fix context leak in list tasks API {es-pull}93431[#93431] (issue: {es-issue}93428[#93428])\n\nTransform::\n* Integrate \"sourceHasChanged\" call into failure handling and retry logic {es-pull}92762[#92762] (issue: {es-issue}92133[#92133])\n\nVector Search::\n* Fix `maxScore` calculation for kNN search {es-pull}93875[#93875]\n* Fix explain for kNN search matches {es-pull}93876[#93876]\n\n[[enhancement-8.7.0]]\n[float]\n=== Enhancements\n\nAggregations::\n* Optimize composite agg with leading global ordinal value source {es-pull}92197[#92197]\n\nAllocation::\n* Add `forecasted_write_load` and `forecasted_shard_size_in_bytes` to the endpoint {es-pull}92303[#92303]\n* Expose tier balancing stats via internal endpoint {es-pull}92199[#92199]\n* Introduce ShardRouting.Role {es-pull}92668[#92668]\n* Prevalidate node removal API (pt. 2) {es-pull}91256[#91256] (issue: {es-issue}87776[#87776])\n* Simulate moves using cluster_concurrent_rebalance=2 {es-pull}93977[#93977]\n* Unpromotables skip replication and peer recovery {es-pull}93210[#93210]\n\nAuthentication::\n* Add new `token_type` setting to JWT realm {es-pull}91536[#91536]\n* JWT realm - Initial support for access tokens {es-pull}91781[#91781]\n* JWT realm - Simplify token principal calculation {es-pull}92315[#92315]\n* JWT realm - add support for required claims {es-pull}92314[#92314]\n* Support custom PBKDF2 password hashes {es-pull}92871[#92871]\n\nAuthorization::\n* Allowed indices matcher supports nested limited roles {es-pull}93306[#93306]\n* Extra `kibana_system` privileges for Fleet transform upgrades {es-pull}91499[#91499]\n* Pre-authorize child search transport actions {es-pull}91886[#91886]\n\nCluster Coordination::\n* Add links to troubleshooting docs {es-pull}92755[#92755] (issue: {es-issue}92741[#92741])\n* Improve node-{join,left} logging for troubleshooting {es-pull}92742[#92742]\n* Repeat `cluster.initial_master_nodes` log warning {es-pull}92744[#92744]\n\nEQL::\n* EQL Samples: add support for multiple samples per key {es-pull}91783[#91783]\n\nEngine::\n* Add commits listener for `InternalEngine` and `CombinedDeletionPolicy` {es-pull}92017[#92017]\n* Add primary term supplier to Engine.IndexCommitListener {es-pull}92101[#92101]\n* Adjust range of allowed percentages of deletes in an index {es-pull}93188[#93188]\n* Diff the list of filenames that are added by each new commit {es-pull}92238[#92238]\n* Set a fixed compound file threshold of 1GB {es-pull}92659[#92659]\n\nGeo::\n* Add methods to H3#hexRing to prevent allocating long arrays {es-pull}92711[#92711]\n* Add methods to prevent allocating long arrays during child navigation on H3 api {es-pull}92099[#92099]\n* Add new H3 api method #h3ToNoChildrenIntersecting {es-pull}91673[#91673]\n* In H3, compute destination point from distance and azimuth using planar 3d math\" {es-pull}93084[#93084]\n* Protect H3 library against integer overflow {es-pull}92829[#92829]\n* Reduce number of object allocations in H3#h3ToGeoBoundary {es-pull}91586[#91586]\n* Speed H3 library by using `FastMath` implementation for trigonometric functions {es-pull}91839[#91839]\n\nHealth::\n* Expose Health Api telemetry via xpack {es-pull}91708[#91708] (issue: {es-issue}90877[#90877])\n* Health api stats {es-pull}91559[#91559]\n\nIndices APIs::\n* Add `ignore_missing_component_templates` config option {es-pull}92436[#92436] (issue: {es-issue}92426[#92426])\n\nInfra/CLI::\n* Scan stable plugins for named components upon install {es-pull}92528[#92528]\n\nInfra/Core::\n* Add log level for JVM logs {es-pull}92382[#92382]\n* Added new field `rollout_duration_seconds` to fleet-actions {es-pull}92640[#92640]\n* Bind the readiness service to the wildcard address {es-pull}91329[#91329] (issue: {es-issue}90997[#90997])\n* Provide locally mounted secure settings implementation {es-pull}93392[#93392]\n\nInfra/Plugins::\n* Check stable plugin version at install and load time {es-pull}91780[#91780]\n* Example stable plugins with settings {es-pull}92334[#92334]\n* Load stable plugins as synthetic modules {es-pull}91869[#91869]\n* Settings api for stable plugins {es-pull}91467[#91467]\n\nInfra/Scripting::\n* Script: Metadata `validateMetadata` optimization {es-pull}93333[#93333]\n* Short-circuit painless def equality {es-pull}92102[#92102]\n* Use primitive types rather than boxing/unboxing for iterating over primitive arrays from defs {es-pull}92025[#92025]\n\nIngest Node::\n* Cache the creation of parsers within DateProcessor {es-pull}92880[#92880]\n* Make `GeoIpProcessor` backing database instance pluggable {es-pull}93285[#93285]\n\nMachine Learning::\n* Add identification of multimodal distribution to anomaly explanations {ml-pull}2440[#2440]\n* Add the ability to include and exclude values in Frequent items {es-pull}92414[#92414]\n* Better error when `aggregate_metric_double` used in scrolling datafeeds {es-pull}92232[#92232] (issue: {es-issue}90592[#90592])\n* Implement extension pruning in frequent items to improve runtime {es-pull}92322[#92322]\n* Improve `frequent_items` performance using global ordinals {es-pull}93304[#93304]\n* Improve anomaly detection results indexing speed {es-pull}92417[#92417]\n* Improve frequent items runtime {es-pull}93255[#93255]\n* Increase the default timeout for the start trained model deployment API {es-pull}92328[#92328]\n* Option to delete user-added annotations for the reset/delete job APIs {es-pull}91698[#91698] (issue: {es-issue}74310[#74310])\n* Persist data counts and datafeed timing stats asynchronously {es-pull}93000[#93000]\n* Remove the PyTorch inference work queue as now handled in Elasticsearch {ml-pull}2456[#2456]\n* Text Embedding search {es-pull}93531[#93531]\n* Upgrade PyTorch to version 1.13.1 {ml-pull}2430[#2430]\n\n\nMapping::\n* Switch to Lucene's new `IntField/LongField/FloatField/DoubleField` {es-pull}93165[#93165]\n\nMonitoring::\n* Add kibana.stats.elasticsearch_client stats to the monitoring index templates. {es-pull}91508[#91508]\n* Add monitoring mappings for es ingest metricset {es-pull}92950[#92950]\n\nNetwork::\n* Deserialize responses on the handling thread-pool {es-pull}91367[#91367]\n\nPerformance::\n* Add vector distance scoring to micro benchmarks {es-pull}92340[#92340]\n\nQuery Languages::\n* Introduce parameterized rule and executor {es-pull}92428[#92428]\n\nRecovery::\n* Make clean up files step configurable for peer-recovery of replicas {es-pull}92490[#92490]\n\nSearch::\n* Access term dictionary more efficiently {es-pull}92269[#92269]\n* Add `term` query support to `rank_features` mapped field {es-pull}93247[#93247]\n* Add new `query_vector_builder` option to knn search clause {es-pull}93331[#93331]\n* Add profiling plugin {es-pull}91640[#91640]\n* Enable profiling plugin by default {es-pull}92787[#92787]\n* Get stackframes and executables more concurrently {es-pull}93559[#93559]\n* Improve the false positive rate of the bloom filter by setting 7 hash functions {es-pull}93283[#93283]\n* Increase the number of threads of GET threadpool {es-pull}92309[#92309]\n* Instrument Weight#count in ProfileWeight {es-pull}85656[#85656] (issue: {es-issue}85203[#85203])\n* Reduce memory usage of match all bitset {es-pull}92777[#92777]\n* Runtime fields to optionally ignore script errors {es-pull}92380[#92380]\n* Speed up retrieval of data for flamegraphs {es-pull}93448[#93448]\n* Support retrieving inlined stack frames {es-pull}92863[#92863]\n* [Profiling] Reduce GC pressure {es-pull}93590[#93590]\n\nSecurity::\n* Configurable retention period for invalidated or expired API keys {es-pull}92219[#92219]\n* Record timestamp on API key invalidation {es-pull}91873[#91873]\n\nSnapshot/Restore::\n* Make `RecoveryPlannerService` optional {es-pull}92489[#92489]\n\nTSDB::\n* Enable bloom filter for `_id` field in tsdb indices {es-pull}92115[#92115]\n* Improve downsampling performance by removing map lookups {es-pull}92494[#92494] (issue: {es-issue}90226[#90226])\n* Minor TSDB parsing speedup {es-pull}92276[#92276]\n* Skip duplicate checks on segments that don't contain the document's timestamp {es-pull}92456[#92456]\n* Support `fields` in synthetic source in last cases {es-pull}91595[#91595]\n\nTask Management::\n* `TransportGetTaskAction:` Wait for the task asynchronously {es-pull}93375[#93375]\n* `TransportListTaskAction:` wait for tasks to finish asynchronously {es-pull}90977[#90977] (issue: {es-issue}89564[#89564])\n\nTransform::\n* Add from parameter to Transform Start API {es-pull}91116[#91116] (issue: {es-issue}88646[#88646])\n* Support \"offset\" parameter in `DateHistogramGroupSource` {es-pull}93203[#93203]\n* Trigger state persistence based on time {es-pull}93221[#93221]\n\nVector Search::\n* Allow `null` to be provided for `dense_vector` field values {es-pull}93388[#93388]\n* Allow more than one KNN search clause {es-pull}92118[#92118] (issue: {es-issue}91187[#91187])\n\nWatcher::\n* Add ability for Watcher's webhook actions to send additional header {es-pull}93426[#93426]\n\n[[feature-8.7.0]]\n[float]\n=== New features\n\nDistributed::\n* Secure settings that can fall back to yml in Stateless {es-pull}91925[#91925]\n\nGeo::\n* Geohex aggregation on `geo_shape` field {es-pull}91956[#91956] (issue: {es-issue}90163[#90163])\n* Support geo_grid ingest processor {es-pull}93370[#93370] (issue: {es-issue}92473[#92473])\n\nHealth::\n* The Health API is now generally available {es-pull}92879[#92879]\n* [HealthAPI] Add size parameter that controls the number of affected resources returned {es-pull}92399[#92399] (issue: {es-issue}91930[#91930])\n* [HealthAPI] Add support for the FEATURE_STATE affected resource {es-pull}92296[#92296] (issue: {es-issue}91353[#91353])\n\nInfra/Plugins::\n* [Fleet] Add files and files data index templates and ILM policies {es-pull}91413[#91413]\n\nIngest Node::\n* Redact Ingest Processor {es-pull}92951[#92951]\n\nMachine Learning::\n* Make `frequent_item_sets` aggregation GA {es-pull}93421[#93421]\n* Make native inference generally available {es-pull}92213[#92213]\n\nTSDB::\n* Add a TSDB rate aggregation {es-pull}90447[#90447]\n* Downsampling GA {es-pull}92913[#92913]\n* Release time_series and rate (on counter fields) aggegations as tech preview {es-pull}93546[#93546]\n* Time series (TSDS) GA {es-pull}91519[#91519]\n\nTransform::\n* Transform _schedule_now API {es-pull}92948[#92948] (issue: {es-issue}44722[#44722])\n\n[[upgrade-8.7.0]]\n[float]\n=== Upgrades\n\nInfra/Core::\n* Align all usages of Jackson to be 2.14.2 {es-pull}93438[#93438]\n\nIngest Node::\n* Upgrading tika to 2.6.0 {es-pull}92104[#92104]\n\nNetwork::\n* Upgrade to Netty 4.1.85 {es-pull}91846[#91846]\n* Upgrade to Netty 4.1.86 {es-pull}92587[#92587]\n\nQuery Languages::\n* Upgrade antlr to 4.11.1 for ql, eql and sql {es-pull}93238[#93238]\n\nSearch::\n* Upgrade to Lucene 9.5.0 {es-pull}93385[#93385]\n* Upgrade to lucene-9.5.0-snapshot-d19c3e2e0ed {es-pull}92957[#92957]\n\nSnapshot/Restore::\n* Align all usages of protobuf to be 3.21.9 {es-pull}92123[#92123]\n* Bump reactor netty version {es-pull}92457[#92457]\n* Consolidate google-oauth-client to latest version {es-pull}91722[#91722]\n\n\n"
}