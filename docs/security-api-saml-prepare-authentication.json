{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.135270",
        "size": 4698,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/security-api-saml-prepare-authentication.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "security-api-saml-prepare-authentication",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[security-api-saml-prepare-authentication]]\n=== SAML prepare authentication API\n++++\n<titleabbrev>SAML prepare authentication</titleabbrev>\n++++\n\nCreates a SAML authentication request (`<AuthnRequest>`) as a URL string, based on the configuration of the respective SAML realm in {es}.\n\nNOTE: This API is intended for use by custom web applications other than {kib}.\nIf you are using {kib}, see the <<saml-guide-stack>>.\n\n[[security-api-saml-prepare-authentication-request]]\n==== {api-request-title}\n\n`POST /_security/saml/prepare`\n\n[[security-api-saml-prepare-authentication-desc]]\n==== {api-description-title}\n\nThis API returns a URL pointing to the SAML Identity\nProvider. You can use the URL to redirect the browser of the user in order to\ncontinue the authentication process. The URL includes a single parameter named `SAMLRequest`,\nwhich contains a SAML Authentication request that is deflated and\nBase64 encoded. If the configuration dictates that SAML authentication requests\nshould be signed, the URL has two extra parameters named `SigAlg` and\n`Signature`. These parameters contain the algorithm used for the signature and\nthe signature value itself.\nIt also returns a random string that uniquely identifies this SAML Authentication request. The\ncaller of this API needs to store this identifier as it needs to used in a following step of\nthe authentication process (see <<security-api-saml-authenticate,SAML authenticate API>>).\n\n{es} exposes all the necessary SAML related functionality via the SAML APIs.\nThese APIs are used internally by {kib} in order to provide SAML based\nauthentication, but can also be used by other custom web applications or other\nclients. See also <<security-api-saml-authenticate,SAML authenticate API>>,\n<<security-api-saml-invalidate,SAML invalidate API>>,\n<<security-api-saml-logout,SAML logout API>>, and\n<<security-api-saml-complete-logout, SAML complete logout API>>.\n\n[[security-api-saml-prepare-authentication-request-body]]\n==== {api-request-body-title}\n\n`acs`::\n  (Optional, string) The Assertion Consumer Service URL that matches the one of the SAML\n  realms in {es}. The realm is used to generate the authentication request.\n  You must specify either this parameter or the `realm` parameter.\n\n`realm`::\n  (Optional, string) The name of the SAML realm in {es} for which the configuration is\n  used to generate the authentication request. You must specify either this parameter or the `acs`\n  parameter.\n\n`relay_state`::\n  (Optional, string) A string that will be included in the redirect URL that this API returns\n  as the `RelayState` query parameter. If the Authentication Request is signed, this value is\n  used as part of the signature computation.\n\n[[security-api-saml-prepare-authentication-response-body]]\n==== {api-response-body-title}\n\n`id`::\n  (string) A unique identifier for the SAML Request to be stored by the caller\n  of the API.\n\n`realm`::\n  (string) The name of the {es} realm that was used to construct the\n  authentication request.\n\n`redirect`::\n  (string) The URL to redirect the user to.\n\n[[security-api-saml-prepare-authentication-example]]\n==== {api-examples-title}\n\nThe following example generates a SAML authentication request for the SAML realm with name `saml1`\n\n[source,console]\n--------------------------------------------------\nPOST /_security/saml/prepare\n{\n  \"realm\" : \"saml1\"\n}\n--------------------------------------------------\n\nThe following example generates a SAML authentication request for the SAML realm with an Assertion\nConsuming Service URL matching `https://kibana.org/api/security/saml/callback\n\n[source,console]\n--------------------------------------------------\nPOST /_security/saml/prepare\n{\n  \"acs\" : \"https://kibana.org/api/security/saml/callback\"\n}\n--------------------------------------------------\n\nThis API returns the following response:\n\n[source,js]\n-------------------------------------------------\n{\n  \"redirect\": \"https://my-idp.org/login?SAMLRequest=fVJdc6IwFP0rmbwDgUKLGbFDtc462%2B06FX3Yl50rBJsKCZsbrPbXL6J22hdfk%2FNx7zl3eL%2BvK7ITBqVWCfVdRolQuS6k2iR0mU2dmN6Phgh1FTQ8be2rehH%2FWoGWdESF%2FPST0NYorgElcgW1QG5zvkh%2FPfHAZbwx2upcV5SkiMLYzmqsFba1MAthdjIXy5enhL5a23DPOyo6W7kGBa7cwhZ2gO7G8OiW%2BR400kORt0bag7fzezAlk24eqcD2OxxlsNN5O3MdsW9c6CZnbq7rntF4d3s0D7BaHTZhIWN52P%2BcjiuGRbDU6cdj%2BEjJbJLQv4N4ADdhxBiEZbQuWclY4Q8iABbCXczCdSiKMAC%2FgyO2YqbQgrIJDZg%2FcFjsMD%2Fzb3gUcBa5sR%2F9oWR%2BzuJBqlPG14Jbn0DIf2TZ3Jn%2FXmSUrC5ddQB6bob37uZrJdeF4dIDHV3iuhb70Ptq83kOz53ubDLXlcwPJK0q%2FT42AqxIaAkVCkqm2tRgr49yfJGFU%2FZQ3hy3QyuUpd7obPv97kb%2FAQ%3D%3D\"}\",\n  \"realm\": \"saml1\",\n  \"id\": \"_989a34500a4f5bf0f00d195aa04a7804b4ed42a1\"\n}\n-------------------------------------------------\n// NOTCONSOLE\n"
}