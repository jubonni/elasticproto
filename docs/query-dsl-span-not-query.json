{
    "meta": {
        "timestamp": "2024-11-01T02:49:26.498067",
        "size": 1592,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-span-not-query.html",
        "type": "documentation",
        "role": [],
        "has_code": true,
        "title": "query-dsl-span-not-query",
        "version": "8.15"
    },
    "doc": "[[query-dsl-span-not-query]]\n=== Span not query\n++++\n<titleabbrev>Span not</titleabbrev>\n++++\n\nRemoves matches which overlap with another span query or which are\nwithin x tokens before (controlled by the parameter `pre`) or y tokens\nafter (controlled by the parameter `post`) another SpanQuery.\nHere is an example:\n\n[source,console]\n--------------------------------------------------\nGET /_search\n{\n  \"query\": {\n    \"span_not\": {\n      \"include\": {\n        \"span_term\": { \"field1\": \"hoya\" }\n      },\n      \"exclude\": {\n        \"span_near\": {\n          \"clauses\": [\n            { \"span_term\": { \"field1\": \"la\" } },\n            { \"span_term\": { \"field1\": \"hoya\" } }\n          ],\n          \"slop\": 0,\n          \"in_order\": true\n        }\n      }\n    }\n  }\n}\n--------------------------------------------------\n\nThe `include` and `exclude` clauses can be any span type query. The\n`include` clause is the span query whose matches are filtered, and the\n`exclude` clause is the span query whose matches must not overlap those\nreturned.\n\nIn the above example all documents with the term hoya are filtered except the ones that have 'la' preceding them.\n\nOther top level options:\n\n[horizontal]\n`pre`::     If set the amount of tokens before the include span can't have overlap with the exclude span. Defaults to 0.\n`post`::    If set the amount of tokens after the include span can't have overlap with the exclude span. Defaults to 0.\n`dist`::    If set the amount of tokens from within the include span can't have overlap with the exclude span. Equivalent\n            of setting both `pre` and `post`.\n"
}