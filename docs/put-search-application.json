{
    "meta": {
        "timestamp": "2024-11-01T03:02:53.242579",
        "size": 6196,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/put-search-application.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "put-search-application",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[put-search-application]]\n=== Put Search Application\n\nbeta::[]\n\n++++\n<titleabbrev>Put Search Application</titleabbrev>\n++++\n\nCreates or updates a Search Application.\n\n[[put-search-application-request]]\n==== {api-request-title}\n\n`PUT _application/search_application/<name>`\n\n[[put-search-application-prereqs]]\n==== {api-prereq-title}\n\nRequires the `manage_search_application` cluster privilege.\nAlso requires <<privileges-list-indices,manage privileges>> on all indices that are added to the Search Application.\n\n[[put-search-application-path-params]]\n==== {api-path-parms-title}\n\n\n`create`::\n(Optional, Boolean) If `true`, this request cannot replace or update existing Search Applications.\nDefaults to `false`.\n\n`<body>`::\n(Required, object)\nContains parameters for a search application:\n+\n.Properties of `<body>` objects\n[%collapsible%open]\n====\n`indices`::\n(Required, array of strings)\nThe <<indices,indices>> associated with this search application. All indices need to exist in order to be added to a search application.\n\n`template`::\n(Optional, object)\nThe <<search-template,search template>> associated with this search application. The search application's template is only stored and accessible through the search application.\n\n- This search template must be a Mustache template.\n- The template must contain a Mustache script and script source.\n- The template may be modified with subsequent <<put-search-application,put search application>> requests.\n- If no template is specified when creating a search application, or if a template is removed from a search application, we use the <<query-string-query-ex-request,query_string>> defined in the template examples as a default.\n- This template will be used by the <<search-application-search,search application search>> API to execute searches.\n- The template accepts an optional `dictionary` parameter which defines a https://json-schema.org[JSON schema] used for validating parameters sent to the <<search-application-search,search application search>> API.\n\n.Properties of `<template>`\n[%collapsible%open]\n=====\n\n`script`::\n(Required, object)\nThe associated mustache template.\n\n[[put-search-application-dictionary-param]]\n`dictionary`::\n(Optional, object)\nThe dictionary used to validate the parameters used with the <<search-application-search, search application search>> API. The dictionary must be a valid JSON schema.\nIf `dictionary` is not specified, then the parameters will not be validated before being applied in the template.\n=====\n====\n\n\n[[put-search-application-response-codes]]\n==== {api-response-codes-title}\n\n`404`::\nSearch Application `<name>` does not exist.\n\n`409`::\nSearch Application `<name>` exists and `create` is `true`.\n\n[[put-search-application-example]]\n==== {api-examples-title}\n\nThe following example creates or updates a new Search Application called `my-app`:\n\n////\n[source,console]\n----\nPUT /index1\n\nPUT /index2\n\nPUT _application/search_application/my-app\n{\n  \"indices\": [ \"index1\", \"index2\" ],\n  \"template\": {\n    \"script\": {\n      \"source\": {\n        \"query\": {\n          \"query_string\": {\n            \"query\": \"{{query_string}}\",\n            \"default_field\": \"{{default_field}}\"\n          }\n        }\n      },\n      \"params\": {\n        \"query_string\": \"*\",\n        \"default_field\": \"*\"\n      }\n    },\n    \"dictionary\": {\n      \"properties\": {\n        \"query_string\": {\n          \"type\": \"string\"\n        },\n        \"default_field\": {\n          \"type\": \"string\",\n          \"enum\": [\n            \"title\",\n            \"description\"\n          ]\n        },\n        \"additionalProperties\": false\n      },\n      \"required\": [\n        \"query_string\"\n      ]\n    }\n  }\n}\n----\n// TESTSETUP\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nDELETE _application/search_application/my-app\n\nDELETE /index1\n\nDELETE /index2\n--------------------------------------------------\n// TEARDOWN\n\n////\n\n[source,console]\n----\nPUT _application/search_application/my-app\n{\n  \"indices\": [ \"index1\", \"index2\" ],\n  \"template\": {\n    \"script\": {\n      \"source\": {\n        \"query\": {\n          \"query_string\": {\n            \"query\": \"{{query_string}}\",\n            \"default_field\": \"{{default_field}}\"\n          }\n        }\n      },\n      \"params\": {\n        \"query_string\": \"*\",\n        \"default_field\": \"*\"\n      }\n    },\n    \"dictionary\": {\n      \"properties\": {\n        \"query_string\": {\n          \"type\": \"string\"\n        },\n        \"default_field\": {\n          \"type\": \"string\",\n          \"enum\": [\n            \"title\",\n            \"description\"\n          ]\n        },\n        \"additionalProperties\": false\n      },\n      \"required\": [\n        \"query_string\"\n      ]\n    }\n  }\n}\n----\n\nWhen the above `dictionary` parameter is specified, the <<search-application-search, search application search>> API will perform the following parameter validation:\n\n* It accepts only the `query_string` and `default_field` parameters\n* It verifies that `query_string` and `default_field` are both strings\n* It accepts `default_field` only if it takes the values `title` or `description`\n\nIf the parameters are not valid, the the <<search-application-search, search application search>> API will return an error.\n[source,console]\n----\nPOST _application/search_application/my-app/_search\n{\n  \"params\": {\n    \"default_field\": \"author\",\n    \"query_string\": \"Jane\"\n  }\n}\n----\n// TEST[catch:bad_request]\n\nIn the above example, the value of the `default_field` parameter is not valid, therefore Elasticsearch will return an error:\n\n[source,JSON]\n----\n{\n  \"error\": {\n    \"root_cause\": [\n      {\n        \"type\": \"validation_exception\",\n        \"reason\": 'Validation Failed: 1: $.default_field: does not have a value in the enumeration [title, description];',\n        \"stack_trace\": ...\n      }\n    ],\n    \"type\": \"validation_exception\",\n    \"reason\": 'Validation Failed: 1: $.default_field: does not have a value in the enumeration [title, description];',\n    \"stack_trace\": ...\n  },\n  \"status\": 400\n}\n----\n// TESTRESPONSE[s/\"stack_trace\": \\.\\.\\./\"stack_trace\": $body.$_path/]\n// Need to use source,JSON above instead console-result, as $ fields are replaced in console-result snippets\n"
}