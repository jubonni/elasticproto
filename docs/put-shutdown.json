{
    "meta": {
        "timestamp": "2024-11-01T03:07:10.248271",
        "size": 4300,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/put-shutdown.html",
        "type": "documentation",
        "role": [
            "child_attributes"
        ],
        "has_code": true,
        "title": "put-shutdown",
        "version": "8.15"
    },
    "doc": "[[put-shutdown]]\n=== Put shutdown API\n\nNOTE: {cloud-only}\n\nPrepares a node to be shut down.\n\n[[put-shutdown-api-request]]\n==== {api-request-title}\n\n`PUT _nodes/<node-id>/shutdown`\n\n[[put-shutdown-api-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the `manage`\n<<privileges-list-cluster,cluster privilege>> to use this API.\n\n* If the <<operator-privileges,{operator-feature}>> is enabled, you must be an operator\nto use this API.\n\n[[put-shutdown-api-desc]]\n==== {api-description-title}\n\nMigrates ongoing tasks and index shards to other nodes as needed\nto prepare a node to be restarted or shut down and removed from the cluster.\nThis ensures that {es} can be stopped safely with minimal disruption to the cluster.\n\nYou must specify the type of shutdown: `restart`, `remove`, or `replace`.\nIf a node is already being prepared for shutdown,\nyou can use this API to change the shutdown type.\n\nIMPORTANT: This API does *NOT* terminate the {es} process.\nMonitor the <<get-shutdown,node shutdown status>> to determine\nwhen it  is safe to stop {es}.\n\n[[put-shutdown-api-path-params]]\n==== {api-path-parms-title}\n\n`<node-id>`::\n(Required, string)\nThe ID of the node you want to prepare for shutdown.\nIf you specify a node that is offline,\nit will be prepared for shut down when it rejoins the cluster.\n\nIMPORTANT: This parameter is *NOT* validated against the cluster's active nodes.\nThis enables you to register a node for shut down while it is offline.\nNo error is thrown if you specify an invalid node ID.\n\n[[put-shutdown-api-params]]\n==== {api-query-parms-title}\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n\n[role=\"child_attributes\"]\n[[put-shutdown-api-request-body]]\n==== {api-request-body-title}\n\n`type`::\n(Required, string)\nValid values are `restart`, `remove`, or `replace`.\nUse `restart` when you need to temporarily shut down a node to perform an upgrade,\nmake configuration changes, or perform other maintenance.\nBecause the node is expected to rejoin the cluster, data is not migrated off of the node.\nUse `remove` when you need to permanently remove a node from the cluster.\nThe node is not marked ready for shutdown until data is migrated off of the node.\nUse `replace` to do a 1:1 replacement of a node with another node. Certain allocation decisions will\nbe ignored (such as disk watermarks) in the interest of true replacement of the source node with the\ntarget node. During a replace-type shutdown, rollover and index creation may result in unassigned\nshards, and shrink may fail until the replacement is complete.\n\n`reason`::\n(Required, string)\nA human-readable reason that the node is being shut down.\nThis field provides information for other cluster operators;\nit does not affect the shut down process.\n\n`allocation_delay`::\n(Optional, string)\nOnly valid if `type` is `restart`. Controls how long {es} will wait for the node to restart and join the cluster before reassigning its shards to other nodes. This works the same as\n<<delayed-allocation,delaying allocation>> with the `index.unassigned.node_left.delayed_timeout` setting. If you specify both a restart allocation delay and an index-level allocation delay, the longer of the two is used.\n\n`target_node_name`::\n(Optional, string)\nOnly valid if `type` is `replace`. Specifies the name of the node that is replacing the node being\nshut down. Shards from the shut down node are only allowed to be allocated to the target node, and\nno other data will be allocated to the target node. During relocation of data certain allocation\nrules are ignored, such as disk watermarks or user attribute filtering rules.\n\n[[put-shutdown-api-example]]\n==== {api-examples-title}\n\nRegister a node for shutdown:\n\n[source,console]\n--------------------------------------------------\nPUT /_nodes/USpTGYaBSIKbgSUJR2Z9lg/shutdown\n{\n  \"type\": \"restart\", <1>\n  \"reason\": \"Demonstrating how the node shutdown API works\",\n  \"allocation_delay\": \"20m\"\n}\n--------------------------------------------------\n\n////\n[source,console-result]\n--------------------------------------------------\n{\n  \"acknowledged\": true\n}\n--------------------------------------------------\n////\n\n<1> Prepares the node to be restarted.\nUse `remove` for nodes that will be permanently removed from the cluster.\n"
}