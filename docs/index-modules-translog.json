{
    "meta": {
        "timestamp": "2024-11-01T02:49:26.725068",
        "size": 3594,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-translog.html",
        "type": "documentation",
        "role": [],
        "has_code": false,
        "title": "index-modules-translog",
        "version": "8.15"
    },
    "doc": "[[index-modules-translog]]\n== Translog\n\nChanges to Lucene are only persisted to disk during a Lucene commit, which is a\nrelatively expensive operation and so cannot be performed after every index or\ndelete operation. Changes that happen after one commit and before another will\nbe removed from the index by Lucene in the event of process exit or hardware\nfailure.\n\nLucene commits are too expensive to perform on every individual change, so each\nshard copy also writes operations into its _transaction log_ known as the\n_translog_. All index and delete operations are written to the translog after\nbeing processed by the internal Lucene index but before they are acknowledged.\nIn the event of a crash, recent operations that have been acknowledged but not\nyet included in the last Lucene commit are instead recovered from the translog\nwhen the shard recovers.\n\nAn {es} <<indices-flush,flush>> is the process of performing a Lucene commit and\nstarting a new translog generation. Flushes are performed automatically in the\nbackground in order to make sure the translog does not grow too large, which\nwould make replaying its operations take a considerable amount of time during\nrecovery.  The translog size will never exceed `1%` of the disk size.\nThe ability to perform a flush manually is also exposed through an\nAPI, although this is rarely needed.\n\n[discrete]\n=== Translog settings\n\nThe data in the translog is only persisted to disk when the translog is\n++fsync++ed and committed. In the event of a hardware failure or an operating\nsystem crash or a JVM crash or a shard failure, any data written since the\nprevious translog commit will be lost.\n\nBy default, `index.translog.durability` is set to `request` meaning that\nElasticsearch will only report success of an index, delete, update, or bulk\nrequest to the client after the translog has been successfully ++fsync++ed and\ncommitted on the primary and on every allocated replica. If\n`index.translog.durability` is set to `async` then Elasticsearch ++fsync++s and\ncommits the translog only every `index.translog.sync_interval` which means that\nany operations that were performed just before a crash may be lost when the node\nrecovers.\n\nThe following <<indices-update-settings,dynamically updatable>> per-index\nsettings control the behaviour of the translog:\n\n`index.translog.sync_interval`::\n\n  How often the translog is ++fsync++ed to disk and committed, regardless of\n  write operations. Defaults to `5s`. Values less than `100ms` are not allowed.\n\n`index.translog.durability`::\n+\n--\n\nWhether or not to `fsync` and commit the translog after every index, delete,\nupdate, or bulk request. This setting accepts the following parameters:\n\n`request`::\n\n    (default) `fsync` and commit after every request. In the event of hardware\n    failure, all acknowledged writes will already have been committed to disk.\n\n`async`::\n\n    `fsync` and commit in the background every `sync_interval`. In\n    the event of a failure, all acknowledged writes since the last\n    automatic commit will be discarded.\n--\n\n`index.translog.flush_threshold_size`::\n\n  The translog stores all operations that are not yet safely persisted in Lucene\n  (i.e., are not part of a Lucene commit point). Although these operations are\n  available for reads, they will need to be replayed if the shard was stopped\n  and had to be recovered.\n  This setting controls the maximum total size of these operations to prevent\n  recoveries from taking too long. Once the maximum size has been reached, a flush\n  will happen, generating a new Lucene commit point. Defaults to `10 GB`.\n \n"
}