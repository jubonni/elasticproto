{
    "meta": {
        "timestamp": "2024-11-01T02:49:26.095068",
        "size": 5049,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-reload-analyzers.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "indices-reload-analyzers",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[indices-reload-analyzers]]\n== Reload search analyzers API\n\nReloads an index's <<search-analyzer,search analyzers>> and their resources.\nFor data streams, the API reloads search analyzers and resources for the\nstream's backing indices.\n\n[source,console]\n--------------------------------------------------\nPOST /my-index-000001/_reload_search_analyzers\nPOST /my-index-000001/_cache/clear?request=true\n--------------------------------------------------\n// TEST[setup:my_index]\n\nIMPORTANT: After reloading the search analyzers you should clear the request\n           cache to make sure it doesn't contain responses derived from the\n           previous versions of the analyzer.\n// the need for this is tracked in https://github.com/elastic/elasticsearch/issues/66722\n\n\n\n[discrete]\n[[indices-reload-analyzers-api-request]]\n=== {api-request-title}\n\n`POST /<target>/_reload_search_analyzers`\n\n`GET /<target>/_reload_search_analyzers`\n\n[discrete]\n[[indices-reload-analyzers-api-prereqs]]\n=== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the `manage`\n<<privileges-list-indices,index privilege>> for the target data stream, index,\nor alias.\n\n[discrete]\n[[indices-reload-analyzers-api-desc]]\n=== {api-description-title}\n\nYou can use the reload search analyzers API\nto pick up changes to synonym files\nused in the <<analysis-synonym-graph-tokenfilter,`synonym_graph`>>\nor <<analysis-synonym-tokenfilter,`synonym`>> token filter\nof a <<search-analyzer,search analyzer>>.\nTo be eligible,\nthe token filter must have an `updateable` flag of `true`\nand only be used in search analyzers.\n\n[NOTE]\n====\nThis API does not perform a reload\nfor each shard of an index.\nInstead,\nit performs a reload for each node\ncontaining index shards.\nAs a result,\nthe total shard count returned by the API\ncan differ from the number of index shards.\n\nBecause reloading affects every node with an index shard,\nits important to update the synonym file\non every data node in the cluster,\nincluding nodes that don't contain a shard replica,\nbefore using this API.\nThis ensures the synonym file is updated\neverywhere in the cluster\nin case shards are relocated\nin the future.\n====\n\n\n[discrete]\n[[indices-reload-analyzers-api-path-params]]\n=== {api-path-parms-title}\n\n`<target>`::\n(Required, string) Comma-separated list of data streams, indices, and aliases\nused to limit the request. Supports wildcards (`*`). To target all data streams\nand indices, use `*` or `_all`.\n\n[discrete]\n[[indices-reload-analyzers-api-query-params]]\n=== {api-query-parms-title}\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=allow-no-indices]\n+\nDefaults to `true`.\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=expand-wildcards]\n+\nDefaults to `open`.\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=index-ignore-unavailable]\n\n\n[discrete]\n[[indices-reload-analyzers-api-example]]\n=== {api-examples-title}\n\nUse the <<indices-create-index, create index API>>\nto create an index with a search analyzer\nthat contains an updateable synonym filter.\n\nNOTE: Using the following analyzer as an index analyzer results in an error.\n\n[source,console]\n--------------------------------------------------\nPUT /my-index-000001\n{\n  \"settings\": {\n    \"index\": {\n      \"analysis\": {\n        \"analyzer\": {\n          \"my_synonyms\": {\n            \"tokenizer\": \"whitespace\",\n            \"filter\": [ \"synonym\" ]\n          }\n        },\n        \"filter\": {\n          \"synonym\": {\n            \"type\": \"synonym_graph\",\n            \"synonyms_path\": \"analysis/synonym.txt\",  <1>\n            \"updateable\": true                        <2>\n          }\n        }\n      }\n    }\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"text\": {\n        \"type\": \"text\",\n        \"analyzer\": \"standard\",\n        \"search_analyzer\": \"my_synonyms\"              <3>\n      }\n    }\n  }\n}\n--------------------------------------------------\n\n<1> Includes a synonym file.\n<2> Marks the token filter as updateable.\n<3> Marks the analyzer as a search analyzer.\n\nAfter updating the synonym file,\nuse the <<indices-reload-analyzers,analyzer reload API>>\nto reload the search analyzer\nand pick up the file changes.\n\n[source,console]\n--------------------------------------------------\nPOST /my-index-000001/_reload_search_analyzers\n--------------------------------------------------\n// TEST[continued]\n\nThe API returns the following response.\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"_shards\": {\n    \"total\": 2,\n    \"successful\": 2,\n    \"failed\": 0\n  },\n  \"reload_details\": [\n    {\n      \"index\": \"my-index-000001\",\n      \"reloaded_analyzers\": [\n        \"my_synonyms\"\n      ],\n      \"reloaded_node_ids\": [\n        \"mfdqTXn_T7SGr2Ho2KT8uw\"\n      ]\n    }\n  ]\n}\n--------------------------------------------------\n// TEST[continued]\n// TESTRESPONSE[s/\"total\": 2/\"total\": $body._shards.total/]\n// TESTRESPONSE[s/\"successful\": 2/\"successful\": $body._shards.successful/]\n// TESTRESPONSE[s/mfdqTXn_T7SGr2Ho2KT8uw/$body.reload_details.0.reloaded_node_ids.0/]\n"
}