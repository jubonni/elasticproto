{
    "meta": {
        "timestamp": "2024-11-01T02:49:26.459067",
        "size": 7166,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-simulate-template.html",
        "type": "documentation",
        "role": [
            "child_attributes",
            "child_attributes"
        ],
        "has_code": true,
        "title": "indices-simulate-template",
        "version": "8.15"
    },
    "doc": "[[indices-simulate-template]]\n=== Simulate index template API\n++++\n<titleabbrev>Simulate template</titleabbrev>\n++++\n\nReturns the index configuration that would be applied by a particular\n<<index-templates, index template>>.\n\n////\n[source,console]\n--------------------------------------------------\nPUT _index_template/template_1\n{\n  \"index_patterns\": [\"te*\", \"bar*\"],\n  \"template\": {\n    \"settings\": {\n      \"number_of_shards\": 1\n    },\n    \"mappings\": {\n      \"_source\": {\n        \"enabled\": false\n      },\n      \"properties\": {\n        \"host_name\": {\n          \"type\": \"keyword\"\n        },\n        \"created_at\": {\n          \"type\": \"date\",\n          \"format\": \"EEE MMM dd HH:mm:ss Z yyyy\"\n        }\n      }\n    },\n    \"aliases\": {\n      \"mydata\": { }\n    }\n  },\n  \"priority\": 10,\n  \"version\": 3,\n  \"_meta\": {\n    \"description\": \"my custom\"\n  }\n}\n--------------------------------------------------\n// TESTSETUP\n\n[source,console]\n--------------------------------------------------\nDELETE _index_template/*\n--------------------------------------------------\n// TEARDOWN\n////\n\n[source,console]\n--------------------------------------------------\nPOST /_index_template/_simulate/template_1\n--------------------------------------------------\n\n[[simulate-template-api-request]]\n==== {api-request-title}\n\n`POST /_index_template/_simulate/<index-template>`\n\n[[simulate-template-api-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have the\n`manage_index_templates` or `manage` <<privileges-list-cluster,cluster\nprivilege>> to use this API.\n\n[[simulate-template-api-path-params]]\n==== {api-path-parms-title}\n\n`<index-template>`::\n(Optional, string)\nName of the index template to simulate.\nTo test a template configuration before you add it to the cluster, \nomit this parameter and specify the template configuration in the request body.\n\n[[simulate-template-api-query-params]]\n==== {api-query-parms-title}\n////\n`cause`::\n(Optional, string) The reason for using the specified template for the simulation. \n////\n\n`create`::\n(Optional, Boolean) If `true`, the template passed in the body is \nonly used if no existing templates match the same index patterns. \nIf `false`, the simulation uses the template with the highest priority.\nNote that the template is not permanently added or updated in either case;\nit is only used for the simulation.\nDefaults to `false`.\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=master-timeout]\n\n`include_defaults`::\n(Optional, Boolean) Functionality in preview:[]. If `true`, return all default settings in the response.\nDefaults to `false`.\n\n[role=\"child_attributes\"]\n[[simulate-template-api-request-body]]\n==== {api-request-body-title}\n\ninclude::{es-ref-dir}/indices/put-index-template.asciidoc[tag=index-template-api-body]\n\n[role=\"child_attributes\"]\n[[simulate-template-api-response-body]]\n==== {api-response-body-title}\n\n`overlapping`::\n(array) Any templates that were superseded by the specified template.\n+\n.Properties of `overlapping`\n[%collapsible%open]\n====\n`index_patterns`:: \n(array) Index patterns that the superseded template applies to.\n\n`name`::\n(string) Name of the superseded template.\n====\n\n`template`::\n(object)\nThe settings, mappings, and aliases that would be applied to matching indices. \n+\n.Properties of `template`\n[%collapsible%open]\n====\n`aliases`::\n(Optional, object of objects) Aliases for the index. If the index template\nincludes `data_stream`, this parameter is not supported.\n+\ninclude::{es-ref-dir}/indices/create-index.asciidoc[tag=aliases-props]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=mappings]\n\ninclude::{es-ref-dir}/rest-api/common-parms.asciidoc[tag=settings]\n====\n\n[[simulate-template-api-example]]\n==== {api-examples-title}\n\n[[simulate-existing-template-ex]]\n===== Simulating an existing template\n\nThe following example creates and simulates a composed template:\n\n[source,console]\n--------------------------------------------------\nPUT /_component_template/ct1                   <1>\n{\n  \"template\": {\n    \"settings\": {\n      \"index.number_of_shards\": 2\n    }\n  }\n}\n\nPUT /_component_template/ct2                    <2>\n{\n  \"template\": {\n    \"settings\": {\n      \"index.number_of_replicas\": 0\n    },\n    \"mappings\": {\n      \"properties\": {\n        \"@timestamp\": {\n          \"type\": \"date\"\n        }\n      }\n    }\n  }\n}\n\nPUT /_index_template/final-template            <3>\n{\n  \"index_patterns\": [\"my-index-*\"],\n  \"composed_of\": [\"ct1\", \"ct2\"],\n  \"priority\": 5\n}\n\nPOST /_index_template/_simulate/final-template <4>\n--------------------------------------------------\n<1> Create a component template (`ct1`) that sets the number of shards to 2\n<2> Create a component template (`ct2`) that sets the number of replicas to 0 and defines a mapping\n<3> Create an index template (`final-template`) that uses the component templates\n<4> Show the configuration applied by the `final-template`\n\nThe response shows the index settings, mappings, and aliases applied by the `final-template`:\n\n[source,console-result]\n---------------------------------------------------------\n{\n  \"template\" : {\n    \"settings\" : {\n      \"index\" : {\n        \"number_of_shards\" : \"2\",  <1>\n        \"number_of_replicas\" : \"0\", <2>\n        \"routing\" : {\n          \"allocation\" : {\n            \"include\" : {\n              \"_tier_preference\" : \"data_content\"\n            }\n          }\n        }\n      }\n    },\n    \"mappings\" : {                 <3>\n      \"properties\" : {\n        \"@timestamp\" : {\n          \"type\" : \"date\"\n        }\n      }\n    },\n    \"aliases\" : { }\n  },\n  \"overlapping\" : [ ]\n}\n---------------------------------------------------------\n<1> Number of shards from `ct1`\n<2> Number of replicas from `ct2`\n<3> Mappings from `ct1`\n\n\n[[simulate-template-config-ex]]\n===== Simulating an arbitrary template configuration\n\nTo see what settings will be applied by a template before you add it to the cluster, \nyou can pass a template configuration in the request body. \nThe specified template is used for the simulation if it has a higher priority than existing templates.\n\n[source,console]\n--------------------------------------------------\nPOST /_index_template/_simulate\n{\n  \"index_patterns\": [\"my-index-*\"],\n  \"composed_of\": [\"ct2\"],\n  \"priority\": 10,\n  \"template\": {\n    \"settings\": {\n      \"index.number_of_replicas\": 1\n    }\n  }\n}\n--------------------------------------------------\n// TEST[continued]\n\nThe response shows any overlapping templates with a lower priority.\n\n[source,console-result]\n---------------------------------------------------------\n{\n  \"template\" : {\n    \"settings\" : {\n      \"index\" : {\n        \"number_of_replicas\" : \"1\",\n        \"routing\" : {\n          \"allocation\" : {\n            \"include\" : {\n              \"_tier_preference\" : \"data_content\"\n            }\n          }\n        }\n      }\n    },\n    \"mappings\" : {\n      \"properties\" : { \n        \"@timestamp\" : {           \n          \"type\" : \"date\"\n        }\n      }\n    },\n    \"aliases\" : { }\n  },\n  \"overlapping\" : [\n    {\n      \"name\" : \"final-template\",\n      \"index_patterns\" : [\n        \"my-index-*\"\n      ]\n    }\n  ]\n}\n---------------------------------------------------------\n"
}