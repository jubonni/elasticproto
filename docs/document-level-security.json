{
    "meta": {
        "size": 2125,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/document-level-security.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": false,
        "title": "document-level-security",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[document-level-security]]\n=== Document level security\n\nDocument level security restricts the documents that users have read access to.\nIn particular, it restricts which documents can be accessed from document-based\nread APIs.\n\nTo enable document level security, you use a query to specify the documents that\neach role can access. The document `query` is associated with a particular data\nstream, index, or wildcard (`*`) pattern and operates in conjunction with the\nprivileges specified for the data streams and indices.\n\nThe specified document `query`:\n\n* Expects the same format as if it was defined in the search request\n* Supports <<templating-role-query,templating a role query>> that can access\nthe details of the currently authenticated user\n* Accepts queries written as either string values or nested JSON\n* Supports the majority of the {es}\n<<query-dsl,Query Domain Specific Language (DSL)>>, with <<field-document-limitations,some limitations>> for field and document level security\n\nIMPORTANT: Omitting the `query` parameter entirely disables document level\nsecurity for the respective indices permission entry.\n\nThe following role definition grants read access only to documents that\nbelong to the `click` category within all the `events-*` data streams and indices:\n\n[source,console]\n----\nPOST /_security/role/click_role\n{\n  \"indices\": [\n    {\n      \"names\": [ \"events-*\" ],\n      \"privileges\": [ \"read\" ],\n      \"query\": \"{\\\"match\\\": {\\\"category\\\": \\\"click\\\"}}\"\n    }\n  ]\n}\n----\n\nYou can write this same query using nested JSON syntax:\n\n[source,console]\n----\nPOST _security/role/click_role\n{\n  \"indices\": [\n    {\n      \"names\": [ \"events-*\" ],\n      \"privileges\": [ \"read\" ],\n      \"query\": {\n        \"match\": {\n          \"category\": \"click\"\n        }\n      }\n    }\n  ]\n}\n----\n\nThe following role grants read access only to the documents whose\n`department_id` equals `12`:\n\n[source,console]\n----\nPOST /_security/role/dept_role\n{\n  \"indices\" : [\n    {\n      \"names\" : [ \"*\" ],\n      \"privileges\" : [ \"read\" ],\n      \"query\" : {\n        \"term\" : { \"department_id\" : 12 }\n      }\n    }\n  ]\n}\n----\n"
}