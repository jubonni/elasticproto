{
    "meta": {
        "size": 6735,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ml-get-bucket.html",
        "type": "documentation",
        "role": [
            "xpack",
            "child_attributes"
        ],
        "has_code": true,
        "title": "ml-get-bucket",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ml-get-bucket]]\n= Get buckets API\n++++\n<titleabbrev>Get buckets</titleabbrev>\n++++\n\nRetrieves {anomaly-job} results for one or more buckets.\n\n[[ml-get-bucket-request]]\n== {api-request-title}\n\n`GET _ml/anomaly_detectors/<job_id>/results/buckets` +\n\n`GET _ml/anomaly_detectors/<job_id>/results/buckets/<timestamp>`\n\n[[ml-get-bucket-prereqs]]\n== {api-prereq-title}\n\n\nRequires the `monitor_ml` cluster privilege. This privilege is included in the \n`machine_learning_user` built-in role.\n\n[[ml-get-bucket-desc]]\n== {api-description-title}\n\nThe get buckets API presents a chronological view of the records, grouped by\nbucket.\n\n[[ml-get-bucket-path-parms]]\n== {api-path-parms-title}\n\n`<job_id>`::\n(Required, string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`<timestamp>`::\n(Optional, string) The timestamp of a single bucket result. If you do not\nspecify this parameter, the API returns information about all buckets.\n\n\n[[ml-get-bucket-query-parms]]\n== {api-query-parms-title}\n\n`anomaly_score`::\n(Optional, double) Returns buckets with anomaly scores greater or equal than\nthis value. Defaults to `0.0`.\n\n`desc`::\n(Optional, Boolean) If true, the buckets are sorted in descending order.\nDefaults to `false`.\n\n`end`::\n(Optional, string) Returns buckets with timestamps earlier than this time.\nDefaults to `-1`, which means it is unset and results are not limited to \nspecific timestamps.\n\n`exclude_interim`::\n(Optional, Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=exclude-interim-results]\n\n`expand`::\n(Optional, Boolean) If true, the output includes anomaly records. Defaults to `false`.\n\n`from`::\n(Optional, integer) Skips the specified number of buckets. Defaults to `0`.\n\n`size`::\n(Optional, integer) Specifies the maximum number of buckets to obtain. Defaults\nto `100`.\n\n`sort`::\n(Optional, string) Specifies the sort field for the requested buckets. By\ndefault, the buckets are sorted by the `timestamp` field.\n\n`start`::\n(Optional, string) Returns buckets with timestamps after this time. Defaults to \n`-1`, which means it is unset and results are not limited to specific \ntimestamps.\n\n[[ml-get-bucket-request-body]]\n== {api-request-body-title}\n\nYou can also specify the query parameters in the request body; the exception are\n`from` and `size`, use `page` instead:\n\n`page`::\n+\n.Properties of `page`\n[%collapsible%open]\n====\n\n`from`:::\n(Optional, integer) Skips the specified number of buckets. Defaults to `0`.\n\n`size`:::\n(Optional, integer) Specifies the maximum number of buckets to obtain. Defaults\nto `100`.\n====\n\n[role=\"child_attributes\"]\n[[ml-get-bucket-results]]\n== {api-response-body-title}\n\nThe API returns an array of bucket objects, which have the following properties:\n\n`anomaly_score`::\n(number) The maximum anomaly score, between 0-100, for any of the bucket\ninfluencers. This is an overall, rate-limited score for the job. All the anomaly \nrecords in the bucket contribute to this score. This value might be updated as\nnew data is analyzed.\n\n`bucket_influencers`::\n(array) An array of bucket influencer objects.\n+\n.Properties of `bucket_influencers`\n[%collapsible%open]\n====\n`anomaly_score`:::\n(number) A normalized score between 0-100, which is calculated for each bucket\ninfluencer. This score might be updated as newer data is analyzed.\n\n`bucket_span`:::\n(number) The length of the bucket in seconds. This value matches the \n`bucket_span` that is specified in the job.\n\n`influencer_field_name`:::\n(string) The field name of the influencer.\n////\n`influencer_field_value`:::\n(string) The field value of the influencer. \n////\n\n`initial_anomaly_score`:::\n(number) The score between 0-100 for each bucket influencer. This score is the\ninitial value that was calculated at the time the bucket was processed.\n\n`is_interim`:::\n(Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=is-interim]\n\n`job_id`:::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`probability`:::\n(number) The probability that the bucket has this behavior, in the range 0 to 1.\nThis value can be held to a high precision of over 300 decimal places, so the\n`anomaly_score` is provided as a human-readable and friendly interpretation of\nthis.\n\n`raw_anomaly_score`:::\n(number) Internal.\n\n`result_type`:::\n(string) Internal. This value is always set to `bucket_influencer`.\n\n`timestamp`:::\n(date) The start time of the bucket for which these results were calculated.\n====\n\n`bucket_span`::\n(number)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=bucket-span-results]\n\n`event_count`::\n(number) The number of input data records processed in this bucket.\n\n`initial_anomaly_score`::\n(number) The maximum `anomaly_score` for any of the bucket influencers. This is\nthe initial value that was calculated at the time the bucket was processed.\n\n`is_interim`::\n(Boolean)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=is-interim]\n\n`job_id`::\n(string)\ninclude::{es-ref-dir}/ml/ml-shared.asciidoc[tag=job-id-anomaly-detection]\n\n`processing_time_ms`::\n(number) The amount of time, in milliseconds, that it took to analyze the\nbucket contents and calculate results.\n\n`result_type`::\n(string) Internal. This value is always set to `bucket`.\n\n`timestamp`::\n(date) The start time of the bucket. This timestamp uniquely identifies the\nbucket. \n+\n--\nNOTE: Events that occur exactly at the timestamp of the bucket are included in\nthe results for the bucket.\n\n--\n\n[[ml-get-bucket-example]]\n== {api-examples-title}\n\n[source,console]\n--------------------------------------------------\nGET _ml/anomaly_detectors/low_request_rate/results/buckets\n{\n  \"anomaly_score\": 80,\n  \"start\": \"1454530200001\"\n}\n--------------------------------------------------\n// TEST[skip:Kibana sample data]\n\nIn this example, the API returns a single result that matches the specified\nscore and time constraints:\n[source,js]\n----\n{\n  \"count\" : 1,\n  \"buckets\" : [\n    {\n      \"job_id\" : \"low_request_rate\",\n      \"timestamp\" : 1578398400000,\n      \"anomaly_score\" : 91.58505459594764,\n      \"bucket_span\" : 3600,\n      \"initial_anomaly_score\" : 91.58505459594764,\n      \"event_count\" : 0,\n      \"is_interim\" : false,\n      \"bucket_influencers\" : [\n        {\n          \"job_id\" : \"low_request_rate\",\n          \"result_type\" : \"bucket_influencer\",\n          \"influencer_field_name\" : \"bucket_time\",\n          \"initial_anomaly_score\" : 91.58505459594764,\n          \"anomaly_score\" : 91.58505459594764,\n          \"raw_anomaly_score\" : 0.5758246639716365,\n          \"probability\" : 1.7340849573442696E-4,\n          \"timestamp\" : 1578398400000,\n          \"bucket_span\" : 3600,\n          \"is_interim\" : false\n        }\n      ],\n      \"processing_time_ms\" : 0,\n      \"result_type\" : \"bucket\"\n    }\n  ]\n}\n----\n"
}