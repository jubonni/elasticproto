{
    "meta": {
        "size": 2953,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/put-enrich-policy-api.html",
        "type": "documentation",
        "role": [
            "xpack",
            "child_attributes"
        ],
        "has_code": true,
        "title": "put-enrich-policy-api",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[put-enrich-policy-api]]\n=== Create enrich policy API\n++++\n<titleabbrev>Create enrich policy</titleabbrev>\n++++\n\nCreates an enrich policy.\n\n////\n[source,console]\n----\nPUT /users\n{\n  \"mappings\": {\n    \"properties\": {\n      \"email\": { \"type\": \"keyword\" }\n    }\n  }\n}\n----\n////\n\n[source,console]\n----\nPUT /_enrich/policy/my-policy\n{\n  \"match\": {\n    \"indices\": \"users\",\n    \"match_field\": \"email\",\n    \"enrich_fields\": [\"first_name\", \"last_name\", \"city\", \"zip\", \"state\"]\n  }\n}\n----\n// TEST[continued]\n\n////\n[source,console]\n--------------------------------------------------\nDELETE /_enrich/policy/my-policy\n--------------------------------------------------\n// TEST[continued]\n////\n\n\n[[put-enrich-policy-api-request]]\n==== {api-request-title}\n\n`PUT /_enrich/policy/<enrich-policy>`\n\n\n[[put-enrich-policy-api-prereqs]]\n==== {api-prereq-title}\n\n// tag::enrich-policy-api-prereqs[]\nTo use enrich policies, you must have:\n\n* `read` index privileges for any indices used\n* The `enrich_user` <<built-in-roles,built-in role>>\n// end::enrich-policy-api-prereqs[]\n\n\n[[put-enrich-policy-api-desc]]\n==== {api-description-title}\n\nUse the create enrich policy API to create a <<enrich-policy,enrich policy>>.\n\n[WARNING]\n====\ninclude::../../enrich.asciidoc[tag=update-enrich-policy]\n====\n\n\n[[put-enrich-policy-api-path-params]]\n==== {api-path-parms-title}\n\n`<enrich-policy>`::\n(Required, string)\nName of the enrich policy to create or update.\n\n[role=\"child_attributes\"]\n[[put-enrich-policy-api-request-body]]\n==== {api-request-body-title}\n\n`<policy-type>`::\n(Required, object)\nConfigures the enrich policy. The field key is the enrich policy type. Valid key\nvalues are:\n+\n--\n`geo_match`:::\nMatches enrich data to incoming documents based on a\n<<query-dsl-geo-shape-query,`geo_shape` query>>. For an example, see\n<<geo-match-enrich-policy-type>>.\n\n`match`:::\nMatches enrich data to incoming documents based on a\n<<query-dsl-term-query,`term` query>>. For an example, see\n<<match-enrich-policy-type>>.\n\n`range`:::\nMatches a number, date, or IP address in incoming documents to a range in the\nenrich index based on a <<query-dsl-term-query,`term` query>>. For an example,\nsee <<range-enrich-policy-type>>.\n--\n+\n.Properties of `<policy-type>`\n[%collapsible%open]\n====\n`indices`::\n(Required, String or array of strings)\nOne or more source indices used to create the enrich index.\n+\nIf multiple indices are specified, they must share a common `match_field`.\n\n`match_field`::\n(Required, string)\nField in source indices used to match incoming documents.\n\n`enrich_fields`::\n(Required, Array of strings)\nFields to add to matching incoming documents. These fields must be present in\nthe source indices.\n\n`query`::\n(Optional, <<query-dsl,Query DSL query object>>)\nQuery used to filter documents in the enrich index. The policy only uses\ndocuments matching this query to enrich incoming documents. Defaults to a\n<<query-dsl-match-all-query,`match_all`>> query.\n====\n"
}