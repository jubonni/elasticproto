{
    "meta": {
        "timestamp": "2024-11-01T02:49:25.074075",
        "size": 3305,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/execute-enrich-policy-api.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "execute-enrich-policy-api",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[execute-enrich-policy-api]]\n=== Execute enrich policy API\n++++\n<titleabbrev>Execute enrich policy</titleabbrev>\n++++\n\nExecutes an existing <<enrich-policy,enrich policy>>.\n\n////\n\n[source,console]\n----\nPUT /users/_doc/1?refresh\n{\n  \"email\": \"mardy.brown@asciidocsmith.com\",\n  \"first_name\": \"Mardy\",\n  \"last_name\": \"Brown\",\n  \"city\": \"New Orleans\",\n  \"county\": \"Orleans\",\n  \"state\": \"LA\",\n  \"zip\": 70116,\n  \"web\": \"mardy.asciidocsmith.com\"\n}\n\nPUT /_enrich/policy/my-policy\n{\n  \"match\": {\n    \"indices\": \"users\",\n    \"match_field\": \"email\",\n    \"enrich_fields\": [\"first_name\", \"last_name\", \"city\", \"zip\", \"state\"]\n  }\n}\n----\n// TESTSETUP\n////\n\n[source,console]\n--------------------------------------------------\nPUT /_enrich/policy/my-policy/_execute?wait_for_completion=false\n--------------------------------------------------\n// TEST[s/\\?wait_for_completion=false//]\n\n////\n[source,console]\n--------------------------------------------------\nDELETE /_enrich/policy/my-policy\n--------------------------------------------------\n// TEST[continued]\n////\n\n\n[[execute-enrich-policy-api-request]]\n==== {api-request-title}\n\n`PUT /_enrich/policy/<enrich-policy>/_execute`\n\n`POST /_enrich/policy/<enrich-policy>/_execute`\n\n\n[[execute-enrich-policy-api-prereqs]]\n==== {api-prereq-title}\n\ninclude::put-enrich-policy.asciidoc[tag=enrich-policy-api-prereqs]\n\n\n[[execute-enrich-policy-api-desc]]\n==== {api-description-title}\n\nUse the execute enrich policy API\nto create the enrich index for an existing enrich policy.\n\n// tag::execute-enrich-policy-def[]\nThe _enrich index_ contains documents from the policy's source indices.\nEnrich indices always begin with `.enrich-*`,\nare read-only,\nand are <<indices-forcemerge,force merged>>.\n\n[WARNING]\n====\nEnrich indices should only be used by the <<enrich-processor,enrich processor>>\nor the <<esql-enrich,{esql} `ENRICH` command>>. Avoid using enrich indices for\nother purposes.\n====\n// end::execute-enrich-policy-def[]\n\n// tag::update-enrich-index[]\nOnce created, you cannot update \nor index documents to an enrich index.\nInstead, update your source indices\nand <<execute-enrich-policy-api,execute>> the enrich policy again.\nThis creates a new enrich index from your updated source indices. \nThe previous enrich index will deleted with a delayed maintenance job. \nBy default this is done every 15 minutes. \n// end::update-enrich-index[]\n\nBy default, this API is synchronous: It returns when a policy has been executed.\nBecause executing a policy performs several operations, it may take a while to\nreturn a response, especially when the source indices are large. This can lead\nto timeouts. To prevent timeouts, set the `wait_for_completion` parameter to\n`false`. This runs the request asynchronously in the background, and returns a\ntask ID. You can use the task ID to manage the request with the <<tasks,task\nmanagement API>>.\n\n[[execute-enrich-policy-api-path-params]]\n==== {api-path-parms-title}\n\n`<enrich-policy>`::\n(Required, string)\nEnrich policy to execute.\n\n[[execute-enrich-policy-api-query-params]]\n==== {api-query-parms-title}\n\n`wait_for_completion`::\n(Optional, Boolean)\nIf `true`, the request blocks until execution is complete. If `false`, the\nrequest returns immediately and execution runs asynchronously in the background.\nDefaults to `true`.\n"
}