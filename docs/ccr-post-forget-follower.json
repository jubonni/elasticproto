{
    "meta": {
        "timestamp": "2024-11-01T03:07:09.926272",
        "size": 5451,
        "url": "https://www.elastic.co/guide/en/elasticsearch/reference/current/ccr-post-forget-follower.html",
        "type": "documentation",
        "role": [
            "xpack"
        ],
        "has_code": true,
        "title": "ccr-post-forget-follower",
        "version": "8.15"
    },
    "doc": "[role=\"xpack\"]\n[[ccr-post-forget-follower]]\n=== Forget follower API\n++++\n<titleabbrev>Forget follower</titleabbrev>\n++++\n\nRemoves the <<xpack-ccr,{ccr}>> follower retention leases from the leader.\n\n[[ccr-post-forget-follower-request]]\n==== {api-request-title}\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nPUT /follower_index/_ccr/follow?wait_for_active_shards=1\n{\n  \"remote_cluster\" : \"remote_cluster\",\n  \"leader_index\" : \"leader_index\"\n}\n--------------------------------------------------\n// TESTSETUP\n// TEST[setup:remote_cluster_and_leader_index]\n\n[source,console]\n--------------------------------------------------\nPOST /follower_index/_ccr/pause_follow\n--------------------------------------------------\n// TEARDOWN\n\n//////////////////////////\n\n[source,console]\n--------------------------------------------------\nPOST /<leader_index>/_ccr/forget_follower\n{\n  \"follower_cluster\" : \"<follower_cluster>\",\n  \"follower_index\" : \"<follower_index>\",\n  \"follower_index_uuid\" : \"<follower_index_uuid>\",\n  \"leader_remote_cluster\" : \"<leader_remote_cluster>\"\n}\n--------------------------------------------------\n// TEST[s/<leader_index>/leader_index/]\n// TEST[s/<follower_cluster>/follower_cluster/]\n// TEST[s/<follower_index>/follower_index/]\n// TEST[s/<follower_index_uuid>/follower_index_uuid/]\n// TEST[s/<leader_remote_cluster>/leader_remote_cluster/]\n// TEST[skip_shard_failures]\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0,\n    \"failures\" : [ ]\n  }\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"total\" : 1/\"total\" : $body._shards.total/]\n// TESTRESPONSE[s/\"successful\" : 1/\"successful\" : $body._shards.successful/]\n// TESTRESPONSE[s/\"failed\" : 0/\"failed\" : $body._shards.failed/]\n// TESTRESPONSE[s/\"failures\" : \\[ \\]/\"failures\" : $body._shards.failures/]\n\n[[ccr-post-forget-follower-prereqs]]\n==== {api-prereq-title}\n\n* If the {es} {security-features} are enabled, you must have `manage_leader_index`\nindex privileges for the leader index. For more information, see\n<<security-privileges>>.\n\n[[ccr-post-forget-follower-desc]]\n==== {api-description-title}\n\nA following index takes out retention leases on its leader index. These\nretention leases are used to increase the likelihood that the shards of the\nleader index retain the history of operations that the shards of the following\nindex need to execute replication. When a follower index is converted to a\nregular index via the <<ccr-post-unfollow,unfollow API>> (either via explicit\nexecution of this API, or implicitly via {ilm}), these retention leases are\nremoved. However, removing these retention leases can fail (e.g., if the remote\ncluster containing the leader index is unavailable). While these retention\nleases will eventually expire on their own, their extended existence can cause\nthe leader index to hold more history than necessary, and prevent {ilm} from\nperforming some operations on the leader index. This API exists to enable\nmanually removing these retention leases when the unfollow API was unable to do\nso.\n\nNOTE: This API does not stop replication by a following index. If you use this\nAPI targeting a follower index that is still actively following, the following\nindex will add back retention leases on the leader. The only purpose of this API\nis to handle the case of failure to remove the following retention leases after\nthe <<ccr-post-unfollow,unfollow API>> is invoked.\n\n[[ccr-post-forget-follower-path-parms]]\n==== {api-path-parms-title}\n\n`<leader_index>`::\n  (Required, string) The name of the leader index.\n\n[[ccr-post-forget-follower-query-params]]\n==== {api-query-parms-title}\n\n`timeout`::\n(Optional, time) Controls the amount of time to wait for results. Defaults to unlimited.\n\n[[ccr-post-forget-follower-request-body]]\n==== {api-request-body-title}\n\n`follower_cluster`::\n  (Required, string) The name of the cluster containing the follower index.\n\n`follower_index`::\n  (Required, string) The name of the follower index.\n\n`follower_index_uuid`::\n  (Required, string) The UUID of the follower index.\n\n`leader_remote_cluster`::\n  (Required, string) The alias (from the perspective of the cluster containing\n  the follower index) of the <<remote-clusters,remote cluster>>\n  containing the leader index.\n\n[[ccr-post-forget-follower-examples]]\n==== {api-examples-title}\n\nThis example removes the follower retention leases for `follower_index` from\n`leader_index`.\n\n[source,console]\n--------------------------------------------------\nPOST /leader_index/_ccr/forget_follower\n{\n  \"follower_cluster\" : \"follower_cluster\",\n  \"follower_index\" : \"follower_index\",\n  \"follower_index_uuid\" : \"vYpnaWPRQB6mNspmoCeYyA\",\n  \"leader_remote_cluster\" : \"leader_cluster\"\n}\n--------------------------------------------------\n// TEST[skip_shard_failures]\n\nThe API returns the following result:\n\n[source,console-result]\n--------------------------------------------------\n{\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0,\n    \"failures\" : [ ]\n  }\n}\n--------------------------------------------------\n// TESTRESPONSE[s/\"total\" : 1/\"total\" : $body._shards.total/]\n// TESTRESPONSE[s/\"successful\" : 1/\"successful\" : $body._shards.successful/]\n// TESTRESPONSE[s/\"failed\" : 0/\"failed\" : $body._shards.failed/]\n// TESTRESPONSE[s/\"failures\" : \\[ \\]/\"failures\" : $body._shards.failures/]\n"
}